<!doctype html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="ru">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css?family=Work+Sans:500,600" rel="stylesheet">
  
    <title>Обновление базы данных &#8212; Документация odoo 13.0</title>
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/patchqueue.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script type="text/javascript" src="../_static/jquery.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap.js"></script>
    <script type="text/javascript" src="../_static/doc.js"></script>
    <script type="text/javascript" src="../_static/jquery.noconflict.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <script type="text/javascript" src="../_static/patchqueue.js"></script><link rel="canonical" href="" />
  
    <link rel="index" title="Алфавитный указатель" href="../genindex.html" />
    <link rel="search" title="Поиск" href="../search.html" />
    <link rel="next" title="Создание локализации" href="localization.html" />
    <link rel="prev" title="Покупки в приложении" href="iap.html" /> 
  </head><body><header class="o_main_header o_has_sub_nav o_inverted has_code_col">
<!-- 
    <div class="o_main_header_main">
      <a class="pull-left o_logo" href="/"></a>
      <a href="#" class="o_mobile_menu_toggle visible-xs-block pull-right">
        <span class="sr-only">Toggle navigation</span>
        <span class="mdi-navigation-menu"></span>
      </a>
      <div class="o_header_buttons">
        <a href="http://www.odoo.com/trial" class="btn btn-primary">Start Now</a>
      </div>
      <ul class="o_primary_nav">
        <li class="dropdown">
          <a href="#" class="dropdown-toggle">Apps</a>
          <div class="dropdown-menu o_secondary_nav">
            <div class="container">
              <div class="row">
                <div class="col-sm-3 o_website_apps">
                  <div class="o_nav_app_family">
                    <span></span> Websites
                    <div>Build great user experience</div>
                  </div>
                  <ul>
                    <li><a href="https://www.odoo.com/page/website-builder">Website Builder</a></li>
                    <li><a href="https://www.odoo.com/page/e-commerce">eCommerce</a></li>
                    <li><a href="https://www.odoo.com/page/blog-engine">Blogs</a></li>
                    <li><a href="https://www.odoo.com/page/community-builder">Forums</a></li>
                    <li><a href="https://www.odoo.com/page/slides">Slides</a></li>
                    <li><a href="https://adspike.odoo.com">SEA</a></li>
                  </ul>
                </div>
                <div class="col-sm-3 o_sale_apps">
                  <div class="o_nav_app_family">
                    <span></span> Sales
                    <div>Boost your success rate</div>
                  </div>
                  <ul>
                    <li><a href="https://www.odoo.com/page/sales">Sales</a></li>
                    <li><a href="https://www.odoo.com/page/crm">CRM</a></li>
                    <li><a href="https://www.odoo.com/page/billing">Invoicing</a></li>
                    <li class="dropdown">
                      <a href="#0" class="dropdown-toggle">Point of Sale</a>
                      <ul>
                        <li><a href="https://www.odoo.com/page/point-of-sale">Shops</a></li>
                        <li><a href="https://www.odoo.com/page/pos-restaurant">Restaurants</a></li>
                      </ul>
                    </li>
                    <li><a href="https://www.odoo.com/page/subscriptions">Subscriptions</a></li>
                    <li><a href="https://www.odoo.com/page/sign">Sign</a></li>
                  </ul>
                </div>
                <div class="col-sm-3 o_operation_apps">
                  <div class="o_nav_app_family">
                    <span></span> Operations
                    <div>It's all about efficiency</div>
                  </div>
                  <ul>
                    <li><a href="https://www.odoo.com/page/accounting">Accounting</a></li>
                    <li><a href="https://www.odoo.com/page/project-management">Project</a></li>
                    <li class="dropdown">
                      <a href="#0" class="dropdown-toggle">Human Resources</a>
                      <ul>
                        <li><a href="https://www.odoo.com/page/recruitment">Recruitment</a></li>
                        <li><a href="https://www.odoo.com/page/employees">Employees</a></li>
                        <li><a href="https://www.odoo.com/page/expenses">Expenses</a></li>
                        <li><a href="https://www.odoo.com/page/appraisal">Appraisal</a></li>
                        <li><a href="https://www.odoo.com/page/fleet">Fleet</a></li>
                        <li><a href="https://www.odoo.com/page/leaves">Leaves</a></li>
                      </ul>
                    </li>
                    <li><a href="https://www.odoo.com/page/warehouse">Inventory</a></li>
                    <li><a href="https://www.odoo.com/page/purchase">Purchase</a></li>
                    <li class="dropdown">
                      <a href="#0" class="dropdown-toggle">Manufacturing</a>
                      <ul>
                        <li><a href="https://www.odoo.com/page/manufacturing">MRP</a></li>
                        <li><a href="https://www.odoo.com/page/plm">PLM</a></li>
                        <li><a href="https://www.odoo.com/page/maintenance">Maintenance</a></li>
                        <li><a href="https://www.odoo.com/page/quality">Quality</a></li>
                      </ul>
                    </li>
                  </ul>
                </div>
                <div class="col-sm-3 o_productivity_apps">
                  <div class="o_nav_app_family">
                    <span></span> Productivity Tools
                    <div>Great Tools = Happy People</div>
                  </div>
                  <ul>
                    <li class="dropdown">
                      <a href="#0" class="dropdown-toggle">Communication</a>
                      <ul>
                        <li><a href="https://www.odoo.com/page/discuss">Discuss</a></li>
                        <li><a href="https://www.odoo.com/page/discuss-groups">Mailing Lists</a></li>
                        <li><a href="https://www.odoo.com/page/notes">Notes</a></li>
                        <li><a href="#">Help desk</a></li>
                        <li><a href="#">Appointment</a></li>
                      </ul>
                    </li>
                    <li><a href="https://www.odoo.com/page/timesheet">Timesheet</a></li>
                    <li><a href="https://www.odoo.com/page/email-marketing">Email Marketing</a></li>
                    <li><a href="https://www.odoo.com/page/events">Events</a></li>
                    <li><a href="https://www.odoo.com/page/survey">Survey</a></li>
                    <li><a href="https://www.odoo.com/page/live-chat">Live Chat</a></li>
                  </ul>
                </div>
              </div>
            </div>
            <a href="http://www.odoo.com/apps/modules" class="o_store_link"><i class="fa fa-cube fa-fw"></i> Third party apps</a>
          </div>
        </li>
        <li><a href="https://www.odoo.com/page/tour">Tour</a></li>
        <li><a href="https://www.odoo.com/pricing">Pricing</a></li>
        <li><a href="https://www.odoo.com/page/docs">Docs</a></li>
      </ul>
    </div>
-->
    <nav class="navbar o_sub_nav">
      <div class="container">
        <div class="navbar-header visible-xs">
            <button type="button" class="navbar-toggle collapsed text-left btn-block" data-toggle="collapse" data-target="#o_sub-menu" aria-expanded="false">
              Navigate
              <span class="mdi-hardware-keyboard-arrow-down pull-right"></span>
            </button>
        </div>

        <div class="collapse navbar-collapse" id="o_sub-menu">
          <ol class="o_breadcrumb breadcrumb nav navbar-left">
              
              





    
        
            <li><a href="../index.html">Developer Doc</a></li>
        
    
    <li class="active"><a href="#">Обновление базы данных</a></li>

              
          </ol>

          <div class="call-to-action navbar-right hidden-xs">
            <a href="http://www.odoo.com/trial" class="btn btn-primary">Start Now</a>
          </div>

          <ul class="navbar-nav navbar-right nav o_sub_nav_actions">
            
              <li class="divider"></li>
            

            
            


            
          </ul>

          <ul class="nav navbar-nav navbar-right">
            

            
            
<!--
<li><a href="https://www.odoo.com/documentation/user/13.0/index.html">User</a></li>
<li><a href="https://www.odoo.com/documentation/13.0/index.html">Developer</a></li>
<li><a href="https://www.odoo.com/documentation/13.0/setup/install.html">Installation</a></li>
<li><a href="https://odoo.com/slides">eLearning</a></li>
<li><a href="https://www.odoo.com/page/odoo-white-paper">White Papers</a></li>
<li><a href="https://www.odoo.com/page/legal">Legal</a></li>
-->
            

            
          </ul>
        </div>
      </div>
    </nav>
  </header><div id="wrap" class="has_code_col">
    
    
    
    <figure class="card top has_banner">
      <span class="card-img" style="background-image: url('../_static/banners/upgrade_api.jpg');"></span>
      <div class="container text-center">
        <h1> Обновление базы данных </h1>
      </div>
    </figure>
    
    
    
      <main class="container has_code_col">
        
        <div class="o_content row">
          
          <aside>
            <div class="navbar-aside text-center">
              <ul class="nav list-group text-left"><li class="list-group-item"><a href="#introduction" class="reference internal ripple">Вступление</a></li><li class="list-group-item"><a href="#the-methods" class="reference internal ripple">Методы</a><ul ><li class="list-group-item"><a href="#creating-a-database-upgrade-request" class="reference internal ripple">Создание запроса на обновление базы данных</a><ul ><li class="list-group-item"><a href="#the-create-method" class="reference internal ripple">Метод `` create``</a><ul ><li class="list-group-item"><a href="#failures" class="reference internal ripple">`` Failures``</a></li><li class="list-group-item"><a href="#request" class="reference internal ripple">`` request``</a></li><li class="list-group-item"><a href="#sample-script" class="reference internal ripple">Пример сценария</a></li></ul></li></ul></li><li class="list-group-item"><a href="#uploading-your-database-dump" class="reference internal ripple">Загрузка дампа вашей базы данных</a><ul ><li class="list-group-item"><a href="#the-upload-method" class="reference internal ripple">Метод `` upload``</a></li><li class="list-group-item"><a href="#the-request-sftp-access-method" class="reference internal ripple">Метод `` request_sftp_access``</a><ul ><li class="list-group-item"><a href="#id1" class="reference internal ripple">`` Failures``</a></li><li class="list-group-item"><a href="#id2" class="reference internal ripple">`` request``</a><ul ><li class="list-group-item"><a href="#using-the-sftp-client" class="reference internal ripple">Использование клиента 'sftp'</a></li></ul></li></ul></li></ul></li><li class="list-group-item"><a href="#asking-to-process-your-request" class="reference internal ripple">Просьба обработать ваш запрос</a><ul ><li class="list-group-item"><a href="#the-process-method" class="reference internal ripple">Метод `` process``</a></li></ul></li><li class="list-group-item"><a href="#asking-to-skip-the-tests" class="reference internal ripple">Просьба пропустить тесты</a><ul ><li class="list-group-item"><a href="#the-skip-test-method" class="reference internal ripple">Метод `` skip_test``</a></li></ul></li><li class="list-group-item"><a href="#obtaining-your-request-status" class="reference internal ripple">Получение статуса вашего запроса</a><ul ><li class="list-group-item"><a href="#the-status-method" class="reference internal ripple">Метод `` status``</a></li><li class="list-group-item"><a href="#sample-output" class="reference internal ripple">Образец вывода</a></li></ul></li><li class="list-group-item"><a href="#downloading-your-database-dump" class="reference internal ripple">Загрузка дампа вашей базы данных</a></li></ul></li></ul>
              
              <p class="gith-container"><a href="https://github.com/odoo/odoo/edit/13.0/doc/webservices/upgrade.rst" class="gith-link">
                  Edit on GitHub
              </a></p>
              
            </div>
          </aside>
          
          <article class="doc-body ">
            
            
  <section id="database-upgrade"><i id="reference-upgrade-api"></i></section><section id="introduction"><h2 >Вступление</h2><p >В этом документе описывается API, используемый для обновления базы данных Odoo до более поздней версии.</p><p >Это позволяет обновлять базу данных без повторной сортировки в html-форму на <a href="https://upgrade.odoo.com" class="external reference">https://upgrade.odoo.com</a>, хотя база данных будет следовать тому же процессу, который описан в этой форме.</p><p >Необходимые шаги:</p><ul ><li ><a href="#upgrade-api-create-method" class="reference internal"><span class="std std-ref">creating a request</span></a></li><li ><a href="#upgrade-api-upload-method" class="reference internal"><span class="std std-ref">uploading a database dump</span></a></li><li ><a href="#upgrade-api-process-method" class="reference internal"><span class="std std-ref">running the upgrade process</span></a></li><li ><a href="#upgrade-api-status-method" class="reference internal"><span class="std std-ref">obtaining the status of the database request</span></a></li><li ><a href="#upgrade-api-download-method" class="reference internal"><span class="std std-ref">downloading the upgraded database dump</span></a></li></ul></section><section id="the-methods"><h2 >Методы</h2></section><section id="creating-a-database-upgrade-request"><i id="upgrade-api-create-method"></i><h3 >Создание запроса на обновление базы данных</h3><p >Это действие создает запрос к базе данных со следующей информацией:</p><ul ><li >ссылка на ваш контракт</li><li >Ваша электронная почта</li><li >целевая версия (версия Odoo, которую вы хотите обновить)</li><li >цель вашего запроса (тест или производство)</li><li >имя дампа базы данных (обязательно, но чисто информативно)</li><li >опционально часовой пояс сервера (для исходной версии Odoo &amp;lt;6.1)</li></ul></section><section id="the-create-method"><h4 >Метод `` create``</h4><section class="code-function"><h6 ><code>https://upgrade.odoo.com/database/v1/create</code></h6><p >Создает запрос на обновление базы данных.</p><div class="code-fields"><div class="code-field"><div class="code-field-name">Параметры</div><div class="code-field-body"><ul ><li ><strong >contract</strong> (<a href="https://docs.python.org/3/library/stdtypes.html#str" title="(в Python v3.8)" class="external reference alert-link"><code >str</code></a>) – (обязательно) ссылка на контракт вашего предприятия</li><li ><strong >email</strong> (<a href="https://docs.python.org/3/library/stdtypes.html#str" title="(в Python v3.8)" class="external reference alert-link"><code >str</code></a>) – (обязательно) ваш адрес электронной почты</li><li ><strong >target</strong> (<a href="https://docs.python.org/3/library/stdtypes.html#str" title="(в Python v3.8)" class="external reference alert-link"><code >str</code></a>) – (требуется) версия Odoo, до которой вы хотите обновить. Допустимые варианты: 11,0, 12,0, 13,0</li><li ><strong >aim</strong> (<a href="https://docs.python.org/3/library/stdtypes.html#str" title="(в Python v3.8)" class="external reference alert-link"><code >str</code></a>) – (обязательно) цель вашего запроса на обновление базы данных. Допустимые варианты: тестирование, производство.</li><li ><strong >filename</strong> (<a href="https://docs.python.org/3/library/stdtypes.html#str" title="(в Python v3.8)" class="external reference alert-link"><code >str</code></a>) – (обязательно) чисто информативное имя для вашего файла дампа базы данных</li><li ><strong >timezone</strong> (<a href="https://docs.python.org/3/library/stdtypes.html#str" title="(в Python v3.8)" class="external reference alert-link"><code >str</code></a>) – (необязательно) часовой пояс, используемый вашим сервером. Только для исходной версии Odoo &amp;lt;6.1</li></ul></div></div><div class="code-field"><div class="code-field-name">Результат</div><div class="code-field-body">результат запроса</div></div><div class="code-field"><div class="code-field-name">Тип результата</div><div class="code-field-body">JSON dictionary</div></div></div></section><p >Метод * create * возвращает словарь JSON, содержащий следующие ключи:</p></section><section id="failures"><i id="upgrade-api-json-failure"></i><h5 >`` Failures``</h5><p >Список ошибок.</p><p >Список словарей, каждый словарь дает информацию об одной конкретной ошибке. Каждый словарь может содержать различные ключи в зависимости от типа ошибки, но вы всегда получите ключи `` reason`` и `` message``:</p><ul ><li >`` причина``: тип ошибки</li><li >`` message``: дружеское сообщение</li></ul><p >Некоторые возможные ключи:</p><ul ><li >`` код``: ошибочное значение</li><li >`` значение``: ошибочное значение</li><li >`` Ожидаемый``: список допустимых значений</li></ul><p >Смотрите пример выходных данных в стороне.</p><div class="setup doc-aside content-switcher"><ul ><li >JSON</li></ul><div class="tabs"><div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;failures&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">&quot;expected&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;11.0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;12.0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;13.0&quot;</span><span class="p">,</span>
      <span class="p">],</span>
      <span class="nt">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Invalid value \&quot;5.0\&quot;&quot;</span><span class="p">,</span>
      <span class="nt">&quot;reason&quot;</span><span class="p">:</span> <span class="s2">&quot;TARGET:INVALID&quot;</span><span class="p">,</span>
      <span class="nt">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;5.0&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;M123456-abcxyz&quot;</span><span class="p">,</span>
      <span class="nt">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Can not find contract M123456-abcxyz&quot;</span><span class="p">,</span>
      <span class="nt">&quot;reason&quot;</span><span class="p">:</span> <span class="s2">&quot;CONTRACT:NOT_FOUND&quot;</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div></div></section><section id="request"><h5 >`` request``</h5><p >Если метод * create * успешен, значение, связанное с ключом * request <a href="#id1"><span id="id2" class="problematic">*</span></a>, будет словарем, содержащим различную информацию о созданном запросе:</p><p >Наиболее важные ключи:</p><ul ><li >`` id``: идентификатор запроса</li><li >`` ключ``: ваш закрытый ключ для этого запроса</li></ul><p >Эти 2 значения будут запрашиваться другими методами (загрузка, обработка и статус)</p><p >Другие ключи будут объяснены в разделе, описывающем метод <a href="#upgrade-api-status-method" class="reference internal"><span class="std std-ref">status method</span></a>.</p></section><section id="sample-script"><h5 >Пример сценария</h5><p >Вот 2 примера создания запроса на обновление базы данных с использованием:</p><ul ><li >один на языке программирования Python с использованием библиотеки запросов</li><li >один на языке программирования bash с использованием <a href="https://curl.haxx.se" class="external reference">curl</a> (инструмент для передачи данных с использованием http) и` jq &lt;<a href="https://stedolan.github.io/jq" class="external reference">https://stedolan.github.io/jq</a>&gt;`_ (Процессор JSON):</li></ul><div class="setup doc-aside content-switcher"><ul ><li >Python 2</li><li >Bash</li></ul><div class="tabs"><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">CREATE_URL</span> <span class="o">=</span> <span class="s2">&quot;https://upgrade.odoo.com/database/v1/create&quot;</span>
<span class="n">CONTRACT</span> <span class="o">=</span> <span class="s2">&quot;M123456-abcdef&quot;</span>
<span class="n">AIM</span> <span class="o">=</span> <span class="s2">&quot;test&quot;</span>
<span class="n">TARGET</span> <span class="o">=</span> <span class="s2">&quot;12.0&quot;</span>
<span class="n">EMAIL</span> <span class="o">=</span> <span class="s2">&quot;john.doe@example.com&quot;</span>
<span class="n">FILENAME</span> <span class="o">=</span> <span class="s2">&quot;db_name.dump&quot;</span>

<span class="n">fields</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;aim&#39;</span><span class="p">,</span> <span class="n">AIM</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="n">EMAIL</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;filename&#39;</span><span class="p">,</span> <span class="n">DB_SOURCE</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;contract&#39;</span><span class="p">,</span> <span class="n">CONTRACT</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">TARGET</span><span class="p">),</span>
<span class="p">])</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">CREATE_URL</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">fields</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="nv">CONTRACT</span><span class="o">=</span>M123456-abcdef
<span class="nv">AIM</span><span class="o">=</span><span class="nb">test</span>
<span class="nv">TARGET</span><span class="o">=</span><span class="m">12</span>.0
<span class="nv">EMAIL</span><span class="o">=</span>john.doe@example.com
<span class="nv">FILENAME</span><span class="o">=</span>db_name.dump
<span class="nv">CREATE_URL</span><span class="o">=</span><span class="s2">&quot;https://upgrade.odoo.com/database/v1/create&quot;</span>
<span class="nv">URL_PARAMS</span><span class="o">=</span><span class="s2">&quot;contract=</span><span class="si">${</span><span class="nv">CONTRACT</span><span class="si">}</span><span class="s2">&amp;aim=</span><span class="si">${</span><span class="nv">AIM</span><span class="si">}</span><span class="s2">&amp;target=</span><span class="si">${</span><span class="nv">TARGET</span><span class="si">}</span><span class="s2">&amp;email=</span><span class="si">${</span><span class="nv">EMAIL</span><span class="si">}</span><span class="s2">&amp;filename=</span><span class="si">${</span><span class="nv">FILENAME</span><span class="si">}</span><span class="s2">&quot;</span>
curl -sS <span class="s2">&quot;</span><span class="si">${</span><span class="nv">CREATE_URL</span><span class="si">}</span><span class="s2">?</span><span class="si">${</span><span class="nv">URL_PARAMS</span><span class="si">}</span><span class="s2">&quot;</span> &gt; create_result.json

<span class="c1"># check for failures</span>
<span class="nv">failures</span><span class="o">=</span><span class="k">$(</span>cat create_result.json <span class="p">|</span> jq -r <span class="s1">&#39;.failures[]&#39;</span><span class="k">)</span>
<span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;</span><span class="nv">$failures</span><span class="s2">&quot;</span> !<span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
  <span class="nb">echo</span> <span class="nv">$failures</span> <span class="p">|</span> jq -r <span class="s1">&#39;.&#39;</span>
  <span class="nb">exit</span> <span class="m">1</span>
<span class="k">fi</span>
</pre></div>
</div>
</div></div></section><section id="uploading-your-database-dump"><i id="upgrade-api-upload-method"></i><h3 >Загрузка дампа вашей базы данных</h3><p >Есть 2 способа загрузить дамп базы данных:</p><ul ><li >метод `` загрузки`` с использованием протокола HTTPS</li><li >метод `` request_sftp_access`` с использованием протокола SFTP</li></ul></section><section id="the-upload-method"><h4 >Метод `` upload``</h4><p >Это самый простой и простой способ загрузки дампа базы данных. Он использует протокол HTTPS.</p><section class="code-function"><h6 ><code>https://upgrade.odoo.com/database/v1/upload</code></h6><p >Загружает дамп базы данных</p><div class="code-fields"><div class="code-field"><div class="code-field-name">Параметры</div><div class="code-field-body"><ul ><li ><strong >key</strong> (<a href="https://docs.python.org/3/library/stdtypes.html#str" title="(в Python v3.8)" class="external reference alert-link"><code >str</code></a>) – (обязательно) ваш закрытый ключ</li><li ><strong >request</strong> (<a href="https://docs.python.org/3/library/stdtypes.html#str" title="(в Python v3.8)" class="external reference alert-link"><code >str</code></a>) – (обязательно) идентификатор вашего запроса</li></ul></div></div><div class="code-field"><div class="code-field-name">Результат</div><div class="code-field-body">результат запроса</div></div><div class="code-field"><div class="code-field-name">Тип результата</div><div class="code-field-body">JSON dictionary</div></div></div></section><p >Идентификатор запроса и закрытый ключ получены с помощью метода <a href="#upgrade-api-create-method" class="reference internal"><span class="std std-ref">create method</span></a></p><p >В результате получается словарь JSON, содержащий список `` failures``, который должен быть пустым, если все прошло нормально.</p><div class="setup doc-aside content-switcher"><ul ><li >Python 2</li><li >Bash</li></ul><div class="tabs"><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">UPLOAD_URL</span> <span class="o">=</span> <span class="s2">&quot;https://upgrade.odoo.com/database/v1/upload&quot;</span>
<span class="n">DUMPFILE</span> <span class="o">=</span> <span class="s2">&quot;/tmp/dump.sql&quot;</span>

<span class="n">fields</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;request&#39;</span><span class="p">,</span> <span class="s1">&#39;10534&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="s1">&#39;Aw7pItGVKFuZ_FOR3U8VFQ==&#39;</span><span class="p">),</span>
<span class="p">])</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Content-Type&quot;</span><span class="p">:</span> <span class="s2">&quot;application/octet-stream&quot;</span><span class="p">}</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">DUMPFILE</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">UPLOAD_URL</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">fields</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="nv">UPLOAD_URL</span><span class="o">=</span><span class="s2">&quot;https://upgrade.odoo.com/database/v1/upload&quot;</span>
<span class="nv">DUMPFILE</span><span class="o">=</span><span class="s2">&quot;openchs.70.cdump&quot;</span>
<span class="nv">KEY</span><span class="o">=</span><span class="s2">&quot;Aw7pItGVKFuZ_FOR3U8VFQ==&quot;</span>
<span class="nv">REQUEST_ID</span><span class="o">=</span><span class="s2">&quot;10534&quot;</span>
<span class="nv">URL_PARAMS</span><span class="o">=</span><span class="s2">&quot;key=</span><span class="si">${</span><span class="nv">KEY</span><span class="si">}</span><span class="s2">&amp;request=</span><span class="si">${</span><span class="nv">REQUEST_ID</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="nv">HEADER</span><span class="o">=</span><span class="s2">&quot;Content-Type: application/octet-stream&quot;</span>
curl -H <span class="nv">$HEADER</span> --data-binary <span class="s2">&quot;@</span><span class="si">${</span><span class="nv">DUMPFILE</span><span class="si">}</span><span class="s2">&quot;</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">UPLOAD_URL</span><span class="si">}</span><span class="s2">?</span><span class="si">${</span><span class="nv">URL_PARAMS</span><span class="si">}</span><span class="s2">&quot;</span>
</pre></div>
</div>
</div></div></section><section id="the-request-sftp-access-method"><i id="upgrade-api-request-sftp-access-method"></i><h4 >Метод `` request_sftp_access``</h4><p >Этот метод рекомендуется для больших дампов базы данных. Он использует протокол SFTP и поддерживает возобновление.</p><p >Он создаст временный SFTP-сервер, к которому вы сможете подключиться, и позволит загружать дамп базы данных с помощью SFTP-клиента.</p><section class="code-function"><h6 ><code>https://upgrade.odoo.com/database/v1/request_sftp_access</code></h6><p >Создает SFTP-сервер</p><div class="code-fields"><div class="code-field"><div class="code-field-name">Параметры</div><div class="code-field-body"><ul ><li ><strong >key</strong> (<a href="https://docs.python.org/3/library/stdtypes.html#str" title="(в Python v3.8)" class="external reference alert-link"><code >str</code></a>) – (обязательно) ваш закрытый ключ</li><li ><strong >request</strong> (<a href="https://docs.python.org/3/library/stdtypes.html#str" title="(в Python v3.8)" class="external reference alert-link"><code >str</code></a>) – (обязательно) идентификатор вашего запроса</li><li ><strong >ssh_keys</strong> (<a href="https://docs.python.org/3/library/stdtypes.html#str" title="(в Python v3.8)" class="external reference alert-link"><code >str</code></a>) – (обязательно) путь к файлу, в котором перечислены открытые ключи ssh, которые вы хотите использовать</li></ul></div></div><div class="code-field"><div class="code-field-name">Результат</div><div class="code-field-body">результат запроса</div></div><div class="code-field"><div class="code-field-name">Тип результата</div><div class="code-field-body">JSON dictionary</div></div></div></section><p >Идентификатор запроса и закрытый ключ получены с помощью метода <a href="#upgrade-api-create-method" class="reference internal"><span class="std std-ref">create method</span></a></p><p >Файл с вашими открытыми ключами ssh должен быть примерно похож на стандартный файл `` половинный_клюзив``. Этот файл должен содержать только открытые ключи, пустые строки или комментарии (строки, начинающиеся с символа `` # <a href="#id1"><span id="id2" class="problematic">``</span></a>)</p><p >Ваш запрос на обновление базы данных должен быть в состоянии `` draft``.</p><p >Метод `` request_sftp_access`` возвращает словарь JSON, содержащий следующие ключи:</p><div class="setup doc-aside content-switcher"><ul ><li >Python 2</li><li >Bash</li></ul><div class="tabs"><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">UPLOAD_URL</span> <span class="o">=</span> <span class="s2">&quot;https://upgrade.odoo.com/database/v1/request_sftp_access&quot;</span>
<span class="n">SSH_KEY</span> <span class="o">=</span> <span class="s2">&quot;$HOME/.ssh/id_rsa.pub&quot;</span>
<span class="n">SSH_KEY_CONTENT</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">SSH_KEY</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="n">fields</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;request&#39;</span><span class="p">,</span> <span class="s1">&#39;10534&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="s1">&#39;Aw7pItGVKFuZ_FOR3U8VFQ==&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;ssh_keys&#39;</span><span class="p">,</span> <span class="n">SSH_KEY_CONTENT</span><span class="p">)</span>
<span class="p">])</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">UPLOAD_URL</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">fields</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="nv">REQUEST_SFTP_ACCESS_URL</span><span class="o">=</span><span class="s2">&quot;https://upgrade.odoo.com/database/v1/request_sftp_access&quot;</span>
<span class="nv">SSH_KEYS</span><span class="o">=</span>/path/to/your/authorized_keys
<span class="nv">KEY</span><span class="o">=</span><span class="s2">&quot;Aw7pItGVKFuZ_FOR3U8VFQ==&quot;</span>
<span class="nv">REQUEST_ID</span><span class="o">=</span><span class="s2">&quot;10534&quot;</span>
<span class="nv">URL_PARAMS</span><span class="o">=</span><span class="s2">&quot;key=</span><span class="si">${</span><span class="nv">KEY</span><span class="si">}</span><span class="s2">&amp;request=</span><span class="si">${</span><span class="nv">REQUEST_ID</span><span class="si">}</span><span class="s2">&quot;</span>

curl -sS <span class="s2">&quot;</span><span class="si">${</span><span class="nv">REQUEST_SFTP_ACCESS_URL</span><span class="si">}</span><span class="s2">?</span><span class="si">${</span><span class="nv">URL_PARAMS</span><span class="si">}</span><span class="s2">&quot;</span> -F <span class="nv">ssh_keys</span><span class="o">=</span>@<span class="si">${</span><span class="nv">SSH_KEYS</span><span class="si">}</span> &gt; request_sftp_result.json

<span class="c1"># check for failures</span>
<span class="nv">failures</span><span class="o">=</span><span class="k">$(</span>cat request_sftp_result.json <span class="p">|</span> jq -r <span class="s1">&#39;.failures[]&#39;</span><span class="k">)</span>
<span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;</span><span class="nv">$failures</span><span class="s2">&quot;</span> !<span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
  <span class="nb">echo</span> <span class="nv">$failures</span> <span class="p">|</span> jq -r <span class="s1">&#39;.&#39;</span>
  <span class="nb">exit</span> <span class="m">1</span>
<span class="k">fi</span>
</pre></div>
</div>
</div></div></section><section id="id1"><h5 >`` Failures``</h5><p >Список ошибок. Смотрите :ref:<a href="#id1"><span id="id2" class="problematic">`</span></a>failures &lt;upgrade-api-json-failure&gt;`для объяснения словаря JSON, возвращаемого в случае сбоя.</p></section><section id="id2"><h5 >`` request``</h5><p >Если вызов успешен, значение, связанное с ключом * request <a href="#id1"><span id="id2" class="problematic">*</span></a>, будет словарем, содержащим параметры соединения SFTP:</p><ul ><li >`` hostname``: адрес хоста для подключения</li><li >`` sftp_port``: порт для подключения</li><li >`` sftp_user``: пользователь SFTP для подключения</li><li >`` shared_file``: имя файла, которое вам нужно использовать (идентично значению `` filename``, которое вы использовали при создании запроса в методе <a href="#upgrade-api-create-method" class="reference internal"><span class="std std-ref">create method</span></a>.)</li><li >`` request_id``: связанный идентификатор запроса на обновление (только информативный, не требуется для соединения)</li><li >`` sample_command``: пример команды с использованием клиента 'sftp'</li></ul><p >Обычно вы должны иметь возможность подключиться, используя пример команды, как есть.</p><p >У вас будет доступ только к `` shared_file``. Другие файлы не будут доступны, и вы не сможете создавать новые файлы в общей среде на SFTP-сервере.</p></section><section id="using-the-sftp-client"><h6 >Использование клиента 'sftp'</h6><p >После того, как вы успешно подключились с помощью SFTP-клиента, вы можете загрузить дамп базы данных. Вот пример сеанса с использованием клиента 'sftp':</p><div class="highlight-default"><div class="highlight"><pre><span></span>$ sftp -P 2200 user_10534@upgrade.odoo.com
Connected to upgrade.odoo.com.
sftp&gt; put /path/to/openchs.70.cdump openchs.70.cdump
Uploading /path/to/openchs.70.cdump to /openchs.70.cdump
sftp&gt; ls -l openchs.70.cdump
-rw-rw-rw-    0 0        0          849920 Aug 30 15:58 openchs.70.cdump
</pre></div>
</div>
<p >Если ваше соединение прервано, вы можете продолжить передачу файла, используя ключ командной строки `` -a``:</p><div class="highlight-text"><div class="highlight"><pre><span></span>sftp&gt; put -a /path/to/openchs.70.cdump openchs.70.cdump
Resuming upload of /path/to/openchs.70.cdump to /openchs.70.cdump
</pre></div>
</div>
<p >Если вы не хотите вводить команду вручную и вам необходимо автоматизировать обновление базы данных с помощью сценария, вы можете использовать командный файл или передать ваши команды в 'sftp':</p><div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">echo</span> <span class="s2">&quot;put /path/to/openchs.70.cdump openchs.70.cdump&quot;</span> <span class="o">|</span> <span class="n">sftp</span> <span class="o">-</span><span class="n">b</span> <span class="o">-</span> <span class="o">-</span><span class="n">P</span> <span class="mi">2200</span> <span class="n">user_10534</span><span class="nd">@upgrade</span><span class="o">.</span><span class="n">odoo</span><span class="o">.</span><span class="n">com</span>
</pre></div>
</div>
<p >Параметр `` -b`` принимает имя файла. Если имя файла `` -<a href="#id1"><span id="id2" class="problematic">``</span></a>, он читает команды из стандартного ввода.</p></section><section id="asking-to-process-your-request"><i id="upgrade-api-process-method"></i><h3 >Просьба обработать ваш запрос</h3><p >Это действие запрашивает платформу обновления для обработки дампа базы данных.</p></section><section id="the-process-method"><h4 >Метод `` process``</h4><section class="code-function"><h6 ><code>https://upgrade.odoo.com/database/v1/process</code></h6><p >Обработать дамп базы данных</p><div class="code-fields"><div class="code-field"><div class="code-field-name">Параметры</div><div class="code-field-body"><ul ><li ><strong >key</strong> (<a href="https://docs.python.org/3/library/stdtypes.html#str" title="(в Python v3.8)" class="external reference alert-link"><code >str</code></a>) – (обязательно) ваш закрытый ключ</li><li ><strong >request</strong> (<a href="https://docs.python.org/3/library/stdtypes.html#str" title="(в Python v3.8)" class="external reference alert-link"><code >str</code></a>) – (обязательно) идентификатор вашего запроса</li></ul></div></div><div class="code-field"><div class="code-field-name">Результат</div><div class="code-field-body">результат запроса</div></div><div class="code-field"><div class="code-field-name">Тип результата</div><div class="code-field-body">JSON dictionary</div></div></div></section><p >Идентификатор запроса и закрытый ключ получены с помощью метода <a href="#upgrade-api-create-method" class="reference internal"><span class="std std-ref">create method</span></a></p><p >В результате получается словарь JSON, содержащий список `` failures``, который должен быть пустым, если все прошло нормально.</p><div class="setup doc-aside content-switcher"><ul ><li >Python 2</li><li >Bash</li></ul><div class="tabs"><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">PROCESS_URL</span> <span class="o">=</span> <span class="s2">&quot;https://upgrade.odoo.com/database/v1/process&quot;</span>

<span class="n">fields</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;request&#39;</span><span class="p">,</span> <span class="s1">&#39;10534&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="s1">&#39;Aw7pItGVKFuZ_FOR3U8VFQ==&#39;</span><span class="p">),</span>
<span class="p">])</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">PROCESS_URL</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">fields</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="nv">PROCESS_URL</span><span class="o">=</span><span class="s2">&quot;https://upgrade.odoo.com/database/v1/process&quot;</span>
<span class="nv">KEY</span><span class="o">=</span><span class="s2">&quot;Aw7pItGVKFuZ_FOR3U8VFQ==&quot;</span>
<span class="nv">REQUEST_ID</span><span class="o">=</span><span class="s2">&quot;10534&quot;</span>
<span class="nv">URL_PARAMS</span><span class="o">=</span><span class="s2">&quot;key=</span><span class="si">${</span><span class="nv">KEY</span><span class="si">}</span><span class="s2">&amp;request=</span><span class="si">${</span><span class="nv">REQUEST_ID</span><span class="si">}</span><span class="s2">&quot;</span>
curl -sS <span class="s2">&quot;</span><span class="si">${</span><span class="nv">PROCESS_URL</span><span class="si">}</span><span class="s2">?</span><span class="si">${</span><span class="nv">URL_PARAMS</span><span class="si">}</span><span class="s2">&quot;</span>
</pre></div>
</div>
</div></div></section><section id="asking-to-skip-the-tests"><i id="upgrade-api-skip-tests"></i><h3 >Просьба пропустить тесты</h3><p >Это действие требует от платформы обновления пропустить тесты по вашему запросу. Если вы не хотите, чтобы Odoo тестировал и проверял миграцию, вы можете обойти этап тестирования и сразу получить перенесенный дамп.</p></section><section id="the-skip-test-method"><h4 >Метод `` skip_test``</h4><section class="code-function"><h6 ><code>https://upgrade.odoo.com/database/v1/skip_test</code></h6><p >Пропустите тесты, доставьте обновленный дамп и установите состояние «доставлено».</p><div class="code-fields"><div class="code-field"><div class="code-field-name">Параметры</div><div class="code-field-body"><ul ><li ><strong >key</strong> (<a href="https://docs.python.org/3/library/stdtypes.html#str" title="(в Python v3.8)" class="external reference alert-link"><code >str</code></a>) – (обязательно) ваш закрытый ключ</li><li ><strong >request</strong> (<a href="https://docs.python.org/3/library/stdtypes.html#str" title="(в Python v3.8)" class="external reference alert-link"><code >str</code></a>) – (обязательно) идентификатор вашего запроса</li></ul></div></div><div class="code-field"><div class="code-field-name">Результат</div><div class="code-field-body">результат запроса</div></div><div class="code-field"><div class="code-field-name">Тип результата</div><div class="code-field-body">JSON dictionary</div></div></div></section><p >Идентификатор запроса и закрытый ключ получены с помощью метода <a href="#upgrade-api-create-method" class="reference internal"><span class="std std-ref">create method</span></a></p><p >В результате получается словарь JSON, содержащий список `` failures``, который должен быть пустым, если все прошло нормально.</p><div class="setup doc-aside content-switcher"><ul ><li >Python 2</li><li >Bash</li></ul><div class="tabs"><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">PROCESS_URL</span> <span class="o">=</span> <span class="s2">&quot;https://upgrade.odoo.com/database/v1/skip_test&quot;</span>

<span class="n">fields</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;request&#39;</span><span class="p">,</span> <span class="s1">&#39;10534&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="s1">&#39;Aw7pItGVKFuZ_FOR3U8VFQ==&#39;</span><span class="p">),</span>
<span class="p">])</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">PROCESS_URL</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">fields</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="nv">PROCESS_URL</span><span class="o">=</span><span class="s2">&quot;https://upgrade.odoo.com/database/v1/skip_test&quot;</span>
<span class="nv">KEY</span><span class="o">=</span><span class="s2">&quot;Aw7pItGVKFuZ_FOR3U8VFQ==&quot;</span>
<span class="nv">REQUEST_ID</span><span class="o">=</span><span class="s2">&quot;10534&quot;</span>
<span class="nv">URL_PARAMS</span><span class="o">=</span><span class="s2">&quot;key=</span><span class="si">${</span><span class="nv">KEY</span><span class="si">}</span><span class="s2">&amp;request=</span><span class="si">${</span><span class="nv">REQUEST_ID</span><span class="si">}</span><span class="s2">&quot;</span>
curl -sS <span class="s2">&quot;</span><span class="si">${</span><span class="nv">PROCESS_URL</span><span class="si">}</span><span class="s2">?</span><span class="si">${</span><span class="nv">URL_PARAMS</span><span class="si">}</span><span class="s2">&quot;</span>
</pre></div>
</div>
</div></div></section><section id="obtaining-your-request-status"><i id="upgrade-api-status-method"></i><h3 >Получение статуса вашего запроса</h3><p >Это действие запрашивает статус вашего запроса на обновление базы данных.</p></section><section id="the-status-method"><h4 >Метод `` status``</h4><section class="code-function"><h6 ><code>https://upgrade.odoo.com/database/v1/status</code></h6><p >Спросите статус запроса на обновление базы данных</p><div class="code-fields"><div class="code-field"><div class="code-field-name">Параметры</div><div class="code-field-body"><ul ><li ><strong >key</strong> (<a href="https://docs.python.org/3/library/stdtypes.html#str" title="(в Python v3.8)" class="external reference alert-link"><code >str</code></a>) – (обязательно) ваш закрытый ключ</li><li ><strong >request</strong> (<a href="https://docs.python.org/3/library/stdtypes.html#str" title="(в Python v3.8)" class="external reference alert-link"><code >str</code></a>) – (обязательно) идентификатор вашего запроса</li></ul></div></div><div class="code-field"><div class="code-field-name">Результат</div><div class="code-field-body">результат запроса</div></div><div class="code-field"><div class="code-field-name">Тип результата</div><div class="code-field-body">JSON dictionary</div></div></div></section><p >Идентификатор запроса и закрытый ключ получены с помощью метода <a href="#upgrade-api-create-method" class="reference internal"><span class="std std-ref">create method</span></a></p><p >В результате получается словарь JSON, содержащий различную информацию о вашем запросе на обновление базы данных.</p><div class="setup doc-aside content-switcher"><ul ><li >Python 2</li><li >Bash</li></ul><div class="tabs"><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">PROCESS_URL</span> <span class="o">=</span> <span class="s2">&quot;https://upgrade.odoo.com/database/v1/status&quot;</span>

<span class="n">fields</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;request&#39;</span><span class="p">,</span> <span class="s1">&#39;10534&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="s1">&#39;Aw7pItGVKFuZ_FOR3U8VFQ==&#39;</span><span class="p">),</span>
<span class="p">])</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">PROCESS_URL</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">fields</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="nv">STATUS_URL</span><span class="o">=</span><span class="s2">&quot;https://upgrade.odoo.com/database/v1/status&quot;</span>
<span class="nv">KEY</span><span class="o">=</span><span class="s2">&quot;Aw7pItGVKFuZ_FOR3U8VFQ==&quot;</span>
<span class="nv">REQUEST_ID</span><span class="o">=</span><span class="s2">&quot;10534&quot;</span>
<span class="nv">URL_PARAMS</span><span class="o">=</span><span class="s2">&quot;key=</span><span class="si">${</span><span class="nv">KEY</span><span class="si">}</span><span class="s2">&amp;request=</span><span class="si">${</span><span class="nv">REQUEST_ID</span><span class="si">}</span><span class="s2">&quot;</span>
curl -sS <span class="s2">&quot;</span><span class="si">${</span><span class="nv">STATUS_URL</span><span class="si">}</span><span class="s2">?</span><span class="si">${</span><span class="nv">URL_PARAMS</span><span class="si">}</span><span class="s2">&quot;</span>
</pre></div>
</div>
</div></div></section><section id="sample-output"><h4 >Образец вывода</h4><p >Ключ `` request`` содержит различную полезную информацию о вашем запросе:</p><dl ><dt >`` Id``</dt><dd >идентификатор запроса</dd><dt >`` Key``</dt><dd >ваш личный ключ</dd><dt >`` email``</dt><dd >адрес электронной почты, который вы указали при создании запроса</dd><dt >`` Target``</dt><dd >целевая версия Odoo, которую вы указали при создании запроса</dd><dt >`` aim``</dt><dd >цель (тестирование, производство) вашего запроса на обновление базы данных, который вы указали при создании запроса</dd><dt >`` Filename``</dt><dd >имя файла, которое вы указали при создании запроса</dd><dt >`` Timezone``</dt><dd >часовой пояс, который вы указали при создании запроса</dd><dt >`` State``</dt><dd >состояние вашего запроса</dd><dt >`` issue_stage``</dt><dd >этап выпуска у нас на главном сервере Odoo</dd><dt >`` issue``</dt><dd >идентификатор проблемы, которую мы создали на главном сервере Odoo</dd><dt >`` Status_url``</dt><dd >URL-адрес для доступа к вашей HTML-странице запроса обновления базы данных</dd><dt >`` notes_url``</dt><dd >URL, чтобы получить заметки об обновлении вашей базы данных</dd><dt >`` Original_sql_url``</dt><dd >URL-адрес, используемый для получения загруженной (не обновленной) базы данных в виде потока SQL</dd><dt >`` Original_dump_url``</dt><dd >URL-адрес, используемый для получения загруженной (не обновленной) базы данных в виде файла архива</dd><dt >`` Upgraded_sql_url``</dt><dd >URL-адрес, используемый для получения обновленной базы данных в виде потока SQL</dd><dt >`` Upgraded_dump_url``</dt><dd >URL-адрес, используемый для получения обновленной базы данных в виде файла архива</dd><dt >`` modules_url``</dt><dd >URL-адрес, используемый для получения ваших пользовательских модулей</dd><dt >`` Filesize``</dt><dd >размер вашего загруженного файла базы данных</dd><dt >`` database_uuid``</dt><dd >Уникальный идентификатор вашей базы данных</dd><dt >`` Created_at``</dt><dd >дата, когда вы создали запрос</dd><dt >`` Estimated_time``</dt><dd >оценка времени, необходимого для обновления вашей базы данных</dd><dt >`` processed_at``</dt><dd >время начала обновления вашей базы данных</dd><dt >`` elapsed``</dt><dd >время, необходимое для обновления вашей базы данных</dd><dt >`` Filestore``</dt><dd >ваши вложения были преобразованы в хранилище файлов</dd><dt >`` Customer_message``</dt><dd >важное сообщение, связанное с вашим запросом</dd><dt >`` database_version``</dt><dd >предполагаемая версия Odoo вашей загруженной (не обновленной) базы данных</dd><dt >`` postgresql``</dt><dd >предполагаемая версия Postgresql вашей загруженной (не обновленной) базы данных</dd><dt >`` Compressions``</dt><dd >методы сжатия, используемые вашей загруженной базой данных</dd></dl><div class="setup doc-aside content-switcher"><ul ><li >JSON</li></ul><div class="tabs"><div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;failures&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;request&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="mi">10534</span><span class="p">,</span>
    <span class="nt">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;Aw7pItGVKFuZ_FOR3U8VFQ==&quot;</span><span class="p">,</span>
    <span class="nt">&quot;email&quot;</span><span class="p">:</span> <span class="s2">&quot;john.doe@example.com&quot;</span><span class="p">,</span>
    <span class="nt">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;12.0&quot;</span><span class="p">,</span>
    <span class="nt">&quot;aim&quot;</span><span class="p">:</span> <span class="s2">&quot;test&quot;</span><span class="p">,</span>
    <span class="nt">&quot;filename&quot;</span><span class="p">:</span> <span class="s2">&quot;db_name.dump&quot;</span><span class="p">,</span>
    <span class="nt">&quot;timezone&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="nt">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;draft&quot;</span><span class="p">,</span>
    <span class="nt">&quot;issue_stage&quot;</span><span class="p">:</span> <span class="s2">&quot;new&quot;</span><span class="p">,</span>
    <span class="nt">&quot;issue&quot;</span><span class="p">:</span> <span class="mi">648398</span><span class="p">,</span>
    <span class="nt">&quot;status_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://upgrade.odoo.com/database/eu1/10534/Aw7pItGVKFuZ_FOR3U8VFQ==/status&quot;</span><span class="p">,</span>
    <span class="nt">&quot;notes_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://upgrade.odoo.com/database/eu1/10534/Aw7pItGVKFuZ_FOR3U8VFQ==/upgraded/notes&quot;</span><span class="p">,</span>
    <span class="nt">&quot;original_sql_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://upgrade.odoo.com/database/eu1/10534/Aw7pItGVKFuZ_FOR3U8VFQ==/original/sql&quot;</span><span class="p">,</span>
    <span class="nt">&quot;original_dump_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://upgrade.odoo.com/database/eu1/10534/Aw7pItGVKFuZ_FOR3U8VFQ==/original/archive&quot;</span><span class="p">,</span>
    <span class="nt">&quot;upgraded_sql_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://upgrade.odoo.com/database/eu1/10534/Aw7pItGVKFuZ_FOR3U8VFQ==/upgraded/sql&quot;</span><span class="p">,</span>
    <span class="nt">&quot;upgraded_dump_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://upgrade.odoo.com/database/eu1/10534/Aw7pItGVKFuZ_FOR3U8VFQ==/upgraded/archive&quot;</span><span class="p">,</span>
    <span class="nt">&quot;modules_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://upgrade.odoo.com/database/eu1/10534/Aw7pItGVKFuZ_FOR3U8VFQ==/modules/archive&quot;</span><span class="p">,</span>
    <span class="nt">&quot;filesize&quot;</span><span class="p">:</span> <span class="s2">&quot;912.99 Kb&quot;</span><span class="p">,</span>
    <span class="nt">&quot;database_uuid&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="nt">&quot;created_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2018-09-09 07:13:49&quot;</span><span class="p">,</span>
    <span class="nt">&quot;estimated_time&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="nt">&quot;processed_at&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="nt">&quot;elapsed&quot;</span><span class="p">:</span> <span class="s2">&quot;00:00&quot;</span><span class="p">,</span>
    <span class="nt">&quot;filestore&quot;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="nt">&quot;customer_message&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="nt">&quot;database_version&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="nt">&quot;postgresql&quot;</span><span class="p">:</span> <span class="s2">&quot;9.4&quot;</span><span class="p">,</span>
    <span class="nt">&quot;compressions&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;pgdmp_custom&quot;</span><span class="p">,</span>
      <span class="s2">&quot;sql&quot;</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></div></section><section id="downloading-your-database-dump"><i id="upgrade-api-download-method"></i><h3 >Загрузка дампа вашей базы данных</h3><p >Помимо загрузки перенесенной базы данных с использованием URL-адреса, предоставленного методом <a href="#upgrade-api-status-method" class="reference internal"><span class="std std-ref">status method</span></a>, вы также можете использовать протокол SFTP, как описано в методе <a href="#upgrade-api-status-method" class="reference internal"><span class="std std-ref">status method</span></a></p><p >Разница в том, что вы сможете загружать только перенесенную базу данных. Загрузка невозможна.</p><p >Ваш запрос на обновление базы данных должен быть в состоянии `` done``.</p><p >После того, как вы успешно подключились с помощью SFTP-клиента, вы можете скачать дамп базы данных. Вот пример сеанса с использованием клиента 'sftp':</p><div class="highlight-default"><div class="highlight"><pre><span></span>$ sftp -P 2200 user_10534@upgrade.odoo.com
Connected to upgrade.odoo.com.
sftp&gt; get upgraded_openchs.70.cdump /path/to/upgraded_openchs.70.cdump
Downloading /upgraded_openchs.70.cdump to /path/to/upgraded_openchs.70.cdump
</pre></div>
</div>
</section>

          </article>
        </div>
        
        <div id="mask"></div>
      </main>
  </div>

  <div class="floating_action_container">
    <a id="floating_action" class="ripple" href="#">
      <i class="mdi-action-explore"></i>
    </a>
    <div id="floating_action_menu">
      <span class="bubble"></span>
      <ul class="list-group content">
        <li class="list-group-item ripple"><a>Cras justo odio</a></li>
        <li class="list-group-item ripple"><a>Dapibus ac facilisis in</a></li>
        <li class="list-group-item ripple"><a>Morbi leo risus</a></li>
        <li class="list-group-item ripple"><a>Porta ac consectetur ac</a></li>
        <li class="list-group-item ripple"><a>Vestibulum at eros</a></li>
      </ul>
    </div>
  </div>
<!-- 
  <footer>
    <div id="footer" class="container">
      <span class="o_logo o_logo_inverse center-block o_footer_logo"></span>
      <div class="row">
        <div class="col-sm-7 col-md-7 col-lg-6">
          <div class="row">
            <div class="col-xs-6 col-sm-4">
              <span class="menu_title">Community</span>
              <ul>
                <li><a href="https://github.com/odoo/odoo">Github</a></li>
                <li><a href="http://www.odoo.com/page/download">Download</a></li>
                <li class="divider"></li>
                <li><a href="http://runbot.odoo.com/runbot/repo/git-github-com-odoo-enterprise-7">Runbot</a></li>
                <li><a href="https://github.com/odoo/odoo/wiki/Translations">Translations</a></li>
                <li class="divider"></li>
                <li><a href="http://www.odoo.com/page/odoo-community">Mailing Lists</a></li>
                <li><a href="http://www.odoo.com/forum/help-1">Forum</a></li>
              </ul>
            </div>
            <div class="col-xs-6 col-sm-4">
              <span class="menu_title">Services</span>
              <ul>
                <li><a href="https://www.odoo.sh">Odoo Cloud Platform</a></li>
                <li class="divider"></li>
                <li><a href="http://www.odoo.com/help">Support</a></li>
                <li><a href="https://upgrade.odoo.com">Upgrade</a></li>
                <li class="divider"></li>
                <li><a href="http://www.odoo.com/partners">Find a partner</a></li>
                <li><a href="http://www.odoo.com/page/become-a-partner">Become a partner</a></li>
                <li class="divider"></li>
                <li><a href="http://training.odoo.com/courses/odoo-functional">Training Center</a></li>
                <li><a href="http://www.odoo.com/page/education-program">Education</a></li>
                <li class="divider"></li>
                <li><a href="http://www.odoo.com/page/security">Security</a></li>
              </ul>
            </div>
            <div class="col-xs-12 col-sm-4 mb64">
              <span class="menu_title">About us</span>
              <ul>
                <li><a href="http://www.odoo.com/page/about-us">Our company</a></li>
                <li><a href="http://www.odoo.com/page/contactus">Contact</a></li>
                <li class="divider" />
                <li><a href="http://www.odoo.com/event">Events</a></li>
                <li><a href="http://www.odoo.com/blog">Blog</a></li>
                <li><a href="http://www.odoo.com/blog/6">Customers</a></li>
                <li class="divider" />
                <li><a href="http://www.odoo.com/jobs">Jobs</a></li>
                <li class="divider" />
                <li><a href="http://www.odoo.com/page/legal">Legal</a> | <a href="http://www.odoo.com/privacy">Privacy</a></li>
              </ul>
            </div>
          </div>
        </div>
        <div class="col-sm-5 col-md-4 col-md-offset-1 col-lg-5 col-lg-offset-1">
          <p>
            <small>
              Odoo is a suite of open source business apps that cover all your company needs: CRM, eCommerce, accounting, inventory, point of sale, project management, etc.
              <br/><br/>
              Odoo's unique value proposition is to be at the same time very easy to use and fully integrated.
            </small>
          </p>
        </div>
      </div>
    </div>
    <div class="o_footer_bottom">
      <div class="container">
        <a class="small" href="http://www.odoo.com/page/website-builder">Website made with <span class="o_logo o_logo_inverse o_logo_15"></span></a>
        <div class="social-links pull-right">
          <a href="http://www.odoo.com/web/about/facebook"><i class="fa fa-facebook"></i></a>
          <a href="http://www.odoo.com/web/about/twitter"><i class="fa fa-twitter"></i></a>
          <a href="http://www.odoo.com/web/about/linkedin"><i class="fa fa-linkedin"></i></a>
          <a href="mailto:info@odoo.com"><i class="fa fa-envelope"></i></a>
        </div>
      </div>
    </div>
  </footer>
  -->
  </body>
</html>