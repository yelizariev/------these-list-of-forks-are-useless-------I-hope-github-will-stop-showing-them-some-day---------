<!doctype html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="ru">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css?family=Work+Sans:500,600" rel="stylesheet">
  
    <title>Руководство Odoo &#8212; Документация odoo 13.0</title>
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/patchqueue.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script type="text/javascript" src="../_static/jquery.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap.js"></script>
    <script type="text/javascript" src="../_static/doc.js"></script>
    <script type="text/javascript" src="../_static/jquery.noconflict.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <script type="text/javascript" src="../_static/patchqueue.js"></script><link rel="canonical" href="" />
  
    <link rel="index" title="Алфавитный указатель" href="../genindex.html" />
    <link rel="search" title="Поиск" href="../search.html" />
    <link rel="next" title="Мобильный JavaScript" href="mobile.html" />
    <link rel="prev" title="Mixins и полезные занятия" href="mixins.html" /> 
  </head><body><header class="o_main_header o_has_sub_nav o_inverted ">
<!-- 
    <div class="o_main_header_main">
      <a class="pull-left o_logo" href="/"></a>
      <a href="#" class="o_mobile_menu_toggle visible-xs-block pull-right">
        <span class="sr-only">Toggle navigation</span>
        <span class="mdi-navigation-menu"></span>
      </a>
      <div class="o_header_buttons">
        <a href="http://www.odoo.com/trial" class="btn btn-primary">Start Now</a>
      </div>
      <ul class="o_primary_nav">
        <li class="dropdown">
          <a href="#" class="dropdown-toggle">Apps</a>
          <div class="dropdown-menu o_secondary_nav">
            <div class="container">
              <div class="row">
                <div class="col-sm-3 o_website_apps">
                  <div class="o_nav_app_family">
                    <span></span> Websites
                    <div>Build great user experience</div>
                  </div>
                  <ul>
                    <li><a href="https://www.odoo.com/page/website-builder">Website Builder</a></li>
                    <li><a href="https://www.odoo.com/page/e-commerce">eCommerce</a></li>
                    <li><a href="https://www.odoo.com/page/blog-engine">Blogs</a></li>
                    <li><a href="https://www.odoo.com/page/community-builder">Forums</a></li>
                    <li><a href="https://www.odoo.com/page/slides">Slides</a></li>
                    <li><a href="https://adspike.odoo.com">SEA</a></li>
                  </ul>
                </div>
                <div class="col-sm-3 o_sale_apps">
                  <div class="o_nav_app_family">
                    <span></span> Sales
                    <div>Boost your success rate</div>
                  </div>
                  <ul>
                    <li><a href="https://www.odoo.com/page/sales">Sales</a></li>
                    <li><a href="https://www.odoo.com/page/crm">CRM</a></li>
                    <li><a href="https://www.odoo.com/page/billing">Invoicing</a></li>
                    <li class="dropdown">
                      <a href="#0" class="dropdown-toggle">Point of Sale</a>
                      <ul>
                        <li><a href="https://www.odoo.com/page/point-of-sale">Shops</a></li>
                        <li><a href="https://www.odoo.com/page/pos-restaurant">Restaurants</a></li>
                      </ul>
                    </li>
                    <li><a href="https://www.odoo.com/page/subscriptions">Subscriptions</a></li>
                    <li><a href="https://www.odoo.com/page/sign">Sign</a></li>
                  </ul>
                </div>
                <div class="col-sm-3 o_operation_apps">
                  <div class="o_nav_app_family">
                    <span></span> Operations
                    <div>It's all about efficiency</div>
                  </div>
                  <ul>
                    <li><a href="https://www.odoo.com/page/accounting">Accounting</a></li>
                    <li><a href="https://www.odoo.com/page/project-management">Project</a></li>
                    <li class="dropdown">
                      <a href="#0" class="dropdown-toggle">Human Resources</a>
                      <ul>
                        <li><a href="https://www.odoo.com/page/recruitment">Recruitment</a></li>
                        <li><a href="https://www.odoo.com/page/employees">Employees</a></li>
                        <li><a href="https://www.odoo.com/page/expenses">Expenses</a></li>
                        <li><a href="https://www.odoo.com/page/appraisal">Appraisal</a></li>
                        <li><a href="https://www.odoo.com/page/fleet">Fleet</a></li>
                        <li><a href="https://www.odoo.com/page/leaves">Leaves</a></li>
                      </ul>
                    </li>
                    <li><a href="https://www.odoo.com/page/warehouse">Inventory</a></li>
                    <li><a href="https://www.odoo.com/page/purchase">Purchase</a></li>
                    <li class="dropdown">
                      <a href="#0" class="dropdown-toggle">Manufacturing</a>
                      <ul>
                        <li><a href="https://www.odoo.com/page/manufacturing">MRP</a></li>
                        <li><a href="https://www.odoo.com/page/plm">PLM</a></li>
                        <li><a href="https://www.odoo.com/page/maintenance">Maintenance</a></li>
                        <li><a href="https://www.odoo.com/page/quality">Quality</a></li>
                      </ul>
                    </li>
                  </ul>
                </div>
                <div class="col-sm-3 o_productivity_apps">
                  <div class="o_nav_app_family">
                    <span></span> Productivity Tools
                    <div>Great Tools = Happy People</div>
                  </div>
                  <ul>
                    <li class="dropdown">
                      <a href="#0" class="dropdown-toggle">Communication</a>
                      <ul>
                        <li><a href="https://www.odoo.com/page/discuss">Discuss</a></li>
                        <li><a href="https://www.odoo.com/page/discuss-groups">Mailing Lists</a></li>
                        <li><a href="https://www.odoo.com/page/notes">Notes</a></li>
                        <li><a href="#">Help desk</a></li>
                        <li><a href="#">Appointment</a></li>
                      </ul>
                    </li>
                    <li><a href="https://www.odoo.com/page/timesheet">Timesheet</a></li>
                    <li><a href="https://www.odoo.com/page/email-marketing">Email Marketing</a></li>
                    <li><a href="https://www.odoo.com/page/events">Events</a></li>
                    <li><a href="https://www.odoo.com/page/survey">Survey</a></li>
                    <li><a href="https://www.odoo.com/page/live-chat">Live Chat</a></li>
                  </ul>
                </div>
              </div>
            </div>
            <a href="http://www.odoo.com/apps/modules" class="o_store_link"><i class="fa fa-cube fa-fw"></i> Third party apps</a>
          </div>
        </li>
        <li><a href="https://www.odoo.com/page/tour">Tour</a></li>
        <li><a href="https://www.odoo.com/pricing">Pricing</a></li>
        <li><a href="https://www.odoo.com/page/docs">Docs</a></li>
      </ul>
    </div>
-->
    <nav class="navbar o_sub_nav">
      <div class="container">
        <div class="navbar-header visible-xs">
            <button type="button" class="navbar-toggle collapsed text-left btn-block" data-toggle="collapse" data-target="#o_sub-menu" aria-expanded="false">
              Navigate
              <span class="mdi-hardware-keyboard-arrow-down pull-right"></span>
            </button>
        </div>

        <div class="collapse navbar-collapse" id="o_sub-menu">
          <ol class="o_breadcrumb breadcrumb nav navbar-left">
              
              





    
        
            <li><a href="../index.html">Developer Doc</a></li>
        
    
    <li class="active"><a href="#">Руководство Odoo</a></li>

              
          </ol>

          <div class="call-to-action navbar-right hidden-xs">
            <a href="http://www.odoo.com/trial" class="btn btn-primary">Start Now</a>
          </div>

          <ul class="navbar-nav navbar-right nav o_sub_nav_actions">
            
              <li class="divider"></li>
            

            
            


            
          </ul>

          <ul class="nav navbar-nav navbar-right">
            

            
            
<!--
<li><a href="https://www.odoo.com/documentation/user/13.0/index.html">User</a></li>
<li><a href="https://www.odoo.com/documentation/13.0/index.html">Developer</a></li>
<li><a href="https://www.odoo.com/documentation/13.0/setup/install.html">Installation</a></li>
<li><a href="https://odoo.com/slides">eLearning</a></li>
<li><a href="https://www.odoo.com/page/odoo-white-paper">White Papers</a></li>
<li><a href="https://www.odoo.com/page/legal">Legal</a></li>
-->
            

            
          </ul>
        </div>
      </div>
    </nav>
  </header><div id="wrap" class="">
    
    
    
    <figure class="card top has_banner">
      <span class="card-img" style="background-image: url('../_static/banners/odoo_guideline.jpg');"></span>
      <div class="container text-center">
        <h1> Руководство Odoo </h1>
      </div>
    </figure>
    
    
    
      <main class="container ">
        
        <div class="o_content row">
          
          <aside>
            <div class="navbar-aside text-center">
              <ul class="nav list-group text-left"><li class="list-group-item"><a href="#module-structure" class="reference internal ripple">Модульная структура</a><ul ><li class="list-group-item"><a href="#directories" class="reference internal ripple">Справочники</a></li><li class="list-group-item"><a href="#file-naming" class="reference internal ripple">Наименование файла</a></li></ul></li><li class="list-group-item"><a href="#xml-files" class="reference internal ripple">XML-файлы</a><ul ><li class="list-group-item"><a href="#format" class="reference internal ripple">Формат</a></li><li class="list-group-item"><a href="#xml-ids-and-naming" class="reference internal ripple">XML-идентификаторы и наименования</a><ul ><li class="list-group-item"><a href="#security-view-and-action" class="reference internal ripple">Безопасность, Просмотр и Действие</a></li><li class="list-group-item"><a href="#inheriting-xml" class="reference internal ripple">Наследование XML</a></li></ul></li></ul></li><li class="list-group-item"><a href="#python" class="reference internal ripple">питон</a><ul ><li class="list-group-item"><a href="#pep8-options" class="reference internal ripple">Варианты PEP8</a></li><li class="list-group-item"><a href="#imports" class="reference internal ripple">импорт</a></li><li class="list-group-item"><a href="#idiomatics-of-programming-python" class="reference internal ripple">Идиоматика программирования (Python)</a></li><li class="list-group-item"><a href="#programming-in-odoo" class="reference internal ripple">Программирование в Odoo</a><ul ><li class="list-group-item"><a href="#make-your-method-work-in-batch" class="reference internal ripple">Сделайте так, чтобы ваш метод работал в пакетном режиме</a></li><li class="list-group-item"><a href="#propagate-the-context" class="reference internal ripple">Распространять контекст</a></li><li class="list-group-item"><a href="#do-not-bypass-the-orm" class="reference internal ripple">Не обходите ОРМ</a></li><li class="list-group-item"><a href="#no-sql-injections-please" class="reference internal ripple">Нет SQL-инъекций, пожалуйста!</a></li><li class="list-group-item"><a href="#think-extendable" class="reference internal ripple">Думайте расширяемый</a></li><li class="list-group-item"><a href="#never-commit-the-transaction" class="reference internal ripple">Никогда не совершайте транзакцию</a></li><li class="list-group-item"><a href="#use-translation-method-correctly" class="reference internal ripple">Используйте метод перевода правильно</a></li></ul></li><li class="list-group-item"><a href="#symbols-and-conventions" class="reference internal ripple">Символы и условные обозначения</a></li></ul></li><li class="list-group-item"><a href="#javascript-and-css" class="reference internal ripple">Javascript и CSS</a><ul ><li class="list-group-item"><a href="#static-files-organization" class="reference internal ripple">Организация статических файлов</a></li><li class="list-group-item"><a href="#javascript-coding-guidelines" class="reference internal ripple">Руководство по кодированию Javascript</a></li><li class="list-group-item"><a href="#css-coding-guidelines" class="reference internal ripple">Руководство по кодированию CSS</a></li></ul></li><li class="list-group-item"><a href="#git" class="reference internal ripple">Гит</a><ul ><li class="list-group-item"><a href="#configure-your-git" class="reference internal ripple">Настройте свой мерзавец</a></li><li class="list-group-item"><a href="#commit-message-structure" class="reference internal ripple">Зафиксировать структуру сообщения</a></li><li class="list-group-item"><a href="#tag-and-module-name" class="reference internal ripple">Тег и название модуля</a></li><li class="list-group-item"><a href="#commit-message-header" class="reference internal ripple">Зафиксировать заголовок сообщения</a></li><li class="list-group-item"><a href="#commit-message-full-description" class="reference internal ripple">Подтвердить сообщение полное описание</a></li></ul></li></ul>
              
              <p class="gith-container"><a href="https://github.com/odoo/odoo/edit/13.0/doc/reference/guidelines.rst" class="gith-link">
                  Edit on GitHub
              </a></p>
              
            </div>
          </aside>
          
          <article class="doc-body ">
            
            
  <section id="odoo-guidelines"><i id="reference-guidelines"></i><p >На этой странице представлены рекомендации по кодированию Odoo. Они направлены на улучшение качества кода приложений Odoo. Действительно, правильный код улучшает читабельность, облегчает обслуживание, помогает при отладке, снижает сложность и повышает надежность. Эти рекомендации должны применяться к каждому новому модулю и ко всем новым разработкам.</p><div role="alert" class="alert alert-warning"><h3 class="alert-title">Предупреждение</h3><p >При изменении существующих файлов в ** стабильной версии ** исходный стиль файла строго заменяет любые другие рекомендации по стилю. Другими словами, пожалуйста, никогда не изменяйте существующие файлы, чтобы применять эти рекомендации. Это позволяет избежать нарушения истории пересмотра строк кода. Дифф должен быть минимальным. Для получения более подробной информации см. Наше руководство по запросу запросов. &lt;<a href="https://odoo.com/submit-pr" class="external reference alert-link">https://odoo.com/submit-pr</a>&gt;`_.</p></div><div role="alert" class="alert alert-warning"><h3 class="alert-title">Предупреждение</h3><p >При изменении существующих файлов в ** основной (разрабатываемой) версии ** примените эти рекомендации к существующему коду только для измененного кода или, если большая часть файла находится в стадии пересмотра. Другими словами, изменяйте структуру существующих файлов, только если она подвергается серьезным изменениям. В этом случае сначала сделайте коммит ** move <a href="#id1"><span id="id2" class="problematic">**</span></a>, затем примените изменения, связанные с этой функцией.</p></div></section><section id="module-structure"><h2 >Модульная структура</h2></section><section id="directories"><h3 >Справочники</h3><p >Модуль организован в важных каталогах. Те содержат бизнес-логику; взгляд на них должен помочь вам понять назначение модуля.</p><ul ><li ><em >data/</em> : demo and data xml</li><li ><em >models/</em> : models definition</li><li ><em >controllers/</em> : contains controllers (HTTP routes)</li><li ><em >views/</em> : contains the views and templates</li><li ><em >static/</em> : contains the web assets, separated into <em >css/, js/, img/, lib/, …</em></li></ul><p >Другие дополнительные каталоги составляют модуль.</p><ul ><li ><em >wizard/</em> : regroups the transient models (<code >models.TransientModel</code>) and their views</li><li ><em >report/</em> : contains the printable reports and models based on SQL views. Python objects and XML views are included in this directory</li><li ><em >tests/</em> : contains the Python tests</li></ul></section><section id="file-naming"><h3 >Наименование файла</h3><p >Наименование файлов важно для быстрого поиска информации через все дополнения odoo. В этом разделе объясняется, как называть файлы в стандартном модуле odoo. В качестве примера мы используем питомник растений &lt;<a href="https://github.com/tivisse/odoodays-2018/tree/master/plant_nursery" class="external reference">https://github.com/tivisse/odoodays-2018/tree/master/plant_nursery</a>&gt;`_ приложение. Он содержит две основные модели * plant.nursery * и * plant.order <a href="#id1"><span id="id2" class="problematic">*</span></a>.</p><p >Что касается * моделей <a href="#id1"><span id="id2" class="problematic">*</span></a>, разделите бизнес-логику на наборы моделей, принадлежащих к одной и той же основной модели. Каждый набор находится в данном файле с именем, основанным на его основной модели. Если существует только одна модель, ее имя совпадает с именем модуля. Каждая унаследованная модель должна быть в своем собственном файле, чтобы помочь понять затронутые модели.</p><div class="highlight-text"><div class="highlight"><pre><span></span>addons/plant_nursery/
|-- models/
|   |-- plant_nursery.py (first main model)
|   |-- plant_order.py (another main model)
|   |-- res_partner.py (inherited Odoo model)
</pre></div>
</div>
<p >Что касается * безопасности <a href="#id1"><span id="id2" class="problematic">*</span></a>, прав доступа и правил, следует использовать два основных файла. Первый - это определение прав доступа, сделанное в файле `` ir.model.access.csv``. Группы пользователей определены в `` &lt;module&gt; _groups.xml``. Правила доступа определены в `` &lt;model&gt; _security.xml``.</p><div class="highlight-text"><div class="highlight"><pre><span></span>addons/plant_nursery/
|-- security/
|   |-- ir.model.access.csv
|   |-- plant_nusery_groups.xml
|   |-- plant_nusery_security.xml
|   |-- plant_order_security.xml
</pre></div>
</div>
<p >Что касается * views <a href="#id1"><span id="id2" class="problematic">*</span></a>, то внутренние представления должны быть разделены как модели и дополнены суффиксом `` _views.xml``. Бэкэнд-просмотры: список, форма, канбан, активность, график, сводка, .. представления. Для облегчения разделения по моделям в представлениях основные меню, не связанные с конкретными действиями, могут быть извлечены в необязательный `` &lt;module&gt; _menus.xml`` file. Шаблоны (страницы QWeb, используемые, в частности, для отображения портала / веб-сайта) и пакеты (импорт ресурсов JS и CSS) помещаются в отдельные файлы. Это соответственно `` &lt;model&gt; _templates.xml`` и `` assets.xml`` файлы.</p><div class="highlight-text"><div class="highlight"><pre><span></span>addons/plant_nursery/
|-- views/
|   | -- assets.xml (import of JS / CSS)
|   | -- plant_nursery_menus.xml (optional definition of main menus)
|   | -- plant_nursery_views.xml (backend views)
|   | -- plant_nursery_templates.xml (portal templates)
|   | -- plant_order_views.xml
|   | -- plant_order_templates.xml
|   | -- res_partner_views.xml
</pre></div>
</div>
<p >Что касается * данных <a href="#id1"><span id="id2" class="problematic">*</span></a>, разделите их по назначению (демо или данные) и основной модели. Имена файлов будут именами main_model с суффиксом `` _demo.xml`` или `` _data.xml``. Например, для приложения, имеющего демонстрацию и данные для своей основной модели, а также подтипы, действия и почтовые шаблоны, связанные с почтовым модулем:</p><div class="highlight-text"><div class="highlight"><pre><span></span>addons/plant_nursery/
|-- data/
|   |-- plant_nursery_data.xml
|   |-- plant_nursery_demo.xml
|   |-- mail_data.xml
</pre></div>
</div>
<p >Что касается * контроллеров <a href="#id1"><span id="id2" class="problematic">*</span></a>, то, как правило, все контроллеры принадлежат одному контроллеру, содержащемуся в файле с именем `` &lt;module_name&gt; .py``. Старое соглашение в Odoo - называть этот файл `` main.py``, но он считается устаревшим. Если вам нужно унаследовать существующий контроллер от другого модуля, сделайте это в `` &lt;inherited_module_name&gt; .py``. Например, добавление контроллера портала в приложение выполняется в `` portal.py``.</p><div class="highlight-text"><div class="highlight"><pre><span></span>addons/plant_nursery/
|-- controllers/
|   |-- plant_nursery.py
|   |-- portal.py (inheriting portal/controllers/portal.py)
|   |-- main.py (deprecated, replaced by plant_nursery.py)
</pre></div>
</div>
<p >Что касается * статических файлов <a href="#id1"><span id="id2" class="problematic">*</span></a>, файлы Javascript следуют во всем мире той же логике, что и модели Python. Каждый компонент должен быть в своем собственном файле со значимым именем. Например, виджеты активности находятся в `` activity.js`` почтового модуля. Подкаталоги также могут быть созданы для структурирования «пакета» (см. Веб-модуль для более подробной информации). Та же логика должна применяться к шаблонам виджетов JS (статические файлы XML) и к их стилям (файлы scss). Не связывайте данные (изображения, библиотеки) за пределами Odoo: не используйте URL-адрес изображения, вместо этого скопируйте его в кодовую базу.</p><p >Что касается * волшебников <a href="#id1"><span id="id2" class="problematic">*</span></a>, соглашение об именах такое же, как и для моделей Python: `` &lt;transient&gt; .py`` и `` &lt;transient&gt; _views.xml``. Оба помещены в каталог мастера. Это наименование происходит от старых приложений odoo, использующих ключевое слово wizard для переходных моделей.</p><div class="highlight-text"><div class="highlight"><pre><span></span>addons/plant_nursery/
|-- wizard/
|   |-- make_plant_order.py
|   |-- make_plant_order_views.xml
</pre></div>
</div>
<p >Относительно * статистических отчетов <a href="#id1"><span id="id2" class="problematic">*</span></a>, сделанных с представлениями Python / SQL и классическими представлениями, является следующее:</p><div class="highlight-text"><div class="highlight"><pre><span></span>addons/plant_nursery/
|-- report/
|   |-- plant_order_report.py
|   |-- plant_order_report_views.xml
</pre></div>
</div>
<p >Что касается * печатных отчетов <a href="#id1"><span id="id2" class="problematic">*</span></a>, которые содержат в основном подготовку данных и имена шаблонов Qweb, это:</p><div class="highlight-text"><div class="highlight"><pre><span></span>addons/plant_nursery/
|-- report/
|   |-- plant_order_reports.xml (report actions, paperformat, ...)
|   |-- plant_order_templates.xml (xml report templates)
</pre></div>
</div>
<p >Таким образом, полное дерево нашего модуля Odoo выглядит</p><div class="highlight-text"><div class="highlight"><pre><span></span>addons/plant_nursery/
|-- __init__.py
|-- __manifest__.py
|-- controllers/
|   |-- __init__.py
|   |-- plant_nursery.py
|   |-- portal.py
|-- data/
|   |-- plant_nursery_data.xml
|   |-- plant_nursery_demo.xml
|   |-- mail_data.xml
|-- models/
|   |-- __init__.py
|   |-- plant_nursery.py
|   |-- plant_order.py
|   |-- res_partner.py
|-- report/
|   |-- __init__.py
|   |-- plant_order_report.py
|   |-- plant_order_report_views.xml
|   |-- plant_order_reports.xml (report actions, paperformat, ...)
|   |-- plant_order_templates.xml (xml report templates)
|-- security/
|   |-- ir.model.access.csv
|   |-- plant_nusery_groups.xml
|   |-- plant_nusery_security.xml
|   |-- plant_order_security.xml
|-- static/
|   |-- img/
|   |   |-- my_little_kitten.png
|   |   |-- troll.jpg
|   |-- lib/
|   |   |-- external_lib/
|   |-- src/
|   |   |-- js/
|   |   |   |-- widget_a.js
|   |   |   |-- widget_b.js
|   |   |-- scss/
|   |   |   |-- widget_a.scss
|   |   |   |-- widget_b.scss
|   |   |-- xml/
|   |   |   |-- widget_a.xml
|   |   |   |-- widget_a.xml
|-- views/
|   |-- assets.xml
|   |-- plant_nursery_menus.xml
|   |-- plant_nursery_views.xml
|   |-- plant_nursery_templates.xml
|   |-- plant_order_views.xml
|   |-- plant_order_templates.xml
|   |-- res_partner_views.xml
|-- wizard/
|   |--make_plant_order.py
|   |--make_plant_order_views.xml
</pre></div>
</div>
<div role="alert" class="alert alert-info"><h3 class="alert-title">Примечание</h3><p >Имена файлов должны содержать только `` [<a href="#id1"><span id="id2" class="problematic">a-z0-9_</span></a>] `` (строчные буквы и цифры и `` <a href="#id1"><span id="id2" class="problematic">_`</span></a><a href="#id3"><span id="id4" class="problematic">`</span></a>)</p></div><div role="alert" class="alert alert-warning"><h3 class="alert-title">Предупреждение</h3><p >Используйте правильные права доступа к файлу: папка 755 и файл 644.</p></div></section><section id="xml-files"><i id="reference-guidelines-xml"></i><h2 >XML-файлы</h2></section><section id="format"><h3 >Формат</h3><p >Чтобы объявить запись в XML, запись ** запись ** (с использованием * &lt;record&gt; <a href="#id1"><span id="id2" class="problematic">*</span></a>) Рекомендовано:</p><ul ><li >Поместите атрибут `` id`` перед `` model``</li><li >Для объявления поля атрибут `` name`` является первым. Затем поместите * значение * либо в тег `` field``, либо в атрибут `` eval``, и, наконец, в другие атрибуты (виджет, опции, …), упорядоченные по важности.</li><li >Попробуйте сгруппировать запись по модели. В случае зависимости между действием / меню / представлениями, это соглашение может не применяться.</li><li >Использовать соглашение об именах, определенное в следующей точке</li><li >Тег * &lt;data&gt; * используется только для установки не обновляемых данных с помощью `` noupdate = 1``. Если в файле присутствуют только не обновляемые данные, для `` noupdate = 1`` можно указать `` &lt;odoo&gt; `` помечать и не устанавливать `` &lt;data&gt; `` тег.</li></ul><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;record</span> <span class="na">id=</span><span class="s">&quot;view_id&quot;</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>view.name<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>object_name<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;priority&quot;</span> <span class="na">eval=</span><span class="s">&quot;16&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;tree&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;my_field_1&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;my_field_2&quot;</span> <span class="na">string=</span><span class="s">&quot;My Label&quot;</span> <span class="na">widget=</span><span class="s">&quot;statusbar&quot;</span> <span class="na">statusbar_visible=</span><span class="s">&quot;draft,sent,progress,done&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/tree&gt;</span>
    <span class="nt">&lt;/field&gt;</span>
<span class="nt">&lt;/record&gt;</span>
</pre></div>
</div>
<p >Odoo поддерживает пользовательские теги, действующие как синтаксический сахар:</p><ul ><li >menuitem: используйте его как ярлык для объявления `` ir.ui.menu``</li><li >template: используйте его для объявления представления QWeb, для которого требуется только раздел `` arch`` представления.</li><li >report: используйте для объявления действия <a href="actions.html#reference-actions-report" class="reference internal"><span class="std std-ref">report action</span></a></li><li >act_window: используйте его, если запись записи не может делать то, что вы хотите</li></ul><p >4 первых тега предпочтительнее записи * record <a href="#id1"><span id="id2" class="problematic">*</span></a>.</p></section><section id="xml-ids-and-naming"><h3 >XML-идентификаторы и наименования</h3></section><section id="security-view-and-action"><h4 >Безопасность, Просмотр и Действие</h4><p >Используйте следующий шаблон:</p><ul ><li >Для меню:: samp: <code >{ &lt;model_name&gt; } _menu</code> или: samp: <a href="#id1"><span id="id2" class="problematic">`</span></a>{ &lt;model_name&gt; } _menu_ {do_stuff} <a href="#id3"><span id="id4" class="problematic">`</span></a>для подменю.</li><li >Для просмотра:: samp: <code >{ &lt;model_name&gt; }_Посмотреть_{ &lt;view_type&gt; } `, где * view_type * - это</code> <code >kanban`</code>,` <code >form`</code>,` <code >tree`</code>,` <code >search`</code>, …</li><li >Для действия: основное действие уважает: samp: <code >{ &lt;model_name&gt; } _Action</code>. Другие имеют суффикс: samp: <a href="#id1"><span id="id2" class="problematic">`</span></a>_ { &lt;detail&gt; } <a href="#id3"><span id="id4" class="problematic">`</span></a>, где * detail * - строчная строка, кратко объясняющая действие. Это используется, только если для модели объявлено несколько действий.</li><li >Для действий в окне: добавьте суффикс имени действия к определенной информации вида, например: samp: <a href="#id1"><span id="id2" class="problematic">`</span></a>{ &lt;model_name&gt; } {_Action_view_ &lt;view_type&gt; } <a href="#id3"><span id="id4" class="problematic">`</span></a>.</li><li >Для группы:: samp: <a href="#id1"><span id="id2" class="problematic">`</span></a>{ &lt;model_name&gt; } {_Group_ &lt;group_name&gt; } <a href="#id3"><span id="id4" class="problematic">`</span></a>где * имя_группы * - это имя группы, обычно« пользователь »,« менеджер », …</li><li >Для правила:: samp: <a href="#id1"><span id="id2" class="problematic">`</span></a>{ &lt;model_name&gt; } {_Rule_ &lt;concerned_group&gt; } <a href="#id3"><span id="id4" class="problematic">`</span></a>where * related_group * - это короткое имя соответствующей группы (« user »для« model_name_group_user »,« public »для публичного пользователя,« company »для правил нескольких компаний, …).</li></ul><p >Имя должно быть идентично идентификатору xml с точками, заменяющими подчеркивание. Действия должны иметь реальное имя, поскольку оно используется в качестве отображаемого имени.</p><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="c">&lt;!-- views  --&gt;</span>
<span class="nt">&lt;record</span> <span class="na">id=</span><span class="s">&quot;model_name_view_form&quot;</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>model.name.view.form<span class="nt">&lt;/field&gt;</span>
    ...
<span class="nt">&lt;/record&gt;</span>

<span class="nt">&lt;record</span> <span class="na">id=</span><span class="s">&quot;model_name_view_kanban&quot;</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>model.name.view.kanban<span class="nt">&lt;/field&gt;</span>
    ...
<span class="nt">&lt;/record&gt;</span>

<span class="c">&lt;!-- actions --&gt;</span>
<span class="nt">&lt;record</span> <span class="na">id=</span><span class="s">&quot;model_name_action&quot;</span> <span class="na">model=</span><span class="s">&quot;ir.act.window&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Model Main Action<span class="nt">&lt;/field&gt;</span>
    ...
<span class="nt">&lt;/record&gt;</span>

<span class="nt">&lt;record</span> <span class="na">id=</span><span class="s">&quot;model_name_action_child_list&quot;</span> <span class="na">model=</span><span class="s">&quot;ir.actions.act_window&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Model Access Childs<span class="nt">&lt;/field&gt;</span>
<span class="nt">&lt;/record&gt;</span>

<span class="c">&lt;!-- menus and sub-menus --&gt;</span>
<span class="nt">&lt;menuitem</span>
    <span class="na">id=</span><span class="s">&quot;model_name_menu_root&quot;</span>
    <span class="na">name=</span><span class="s">&quot;Main Menu&quot;</span>
    <span class="na">sequence=</span><span class="s">&quot;5&quot;</span>
<span class="nt">/&gt;</span>
<span class="nt">&lt;menuitem</span>
    <span class="na">id=</span><span class="s">&quot;model_name_menu_action&quot;</span>
    <span class="na">name=</span><span class="s">&quot;Sub Menu 1&quot;</span>
    <span class="na">parent=</span><span class="s">&quot;module_name.module_name_menu_root&quot;</span>
    <span class="na">action=</span><span class="s">&quot;model_name_action&quot;</span>
    <span class="na">sequence=</span><span class="s">&quot;10&quot;</span>
<span class="nt">/&gt;</span>

<span class="c">&lt;!-- security --&gt;</span>
<span class="nt">&lt;record</span> <span class="na">id=</span><span class="s">&quot;module_name_group_user&quot;</span> <span class="na">model=</span><span class="s">&quot;res.groups&quot;</span><span class="nt">&gt;</span>
    ...
<span class="nt">&lt;/record&gt;</span>

<span class="nt">&lt;record</span> <span class="na">id=</span><span class="s">&quot;model_name_rule_public&quot;</span> <span class="na">model=</span><span class="s">&quot;ir.rule&quot;</span><span class="nt">&gt;</span>
    ...
<span class="nt">&lt;/record&gt;</span>

<span class="nt">&lt;record</span> <span class="na">id=</span><span class="s">&quot;model_name_rule_company&quot;</span> <span class="na">model=</span><span class="s">&quot;ir.rule&quot;</span><span class="nt">&gt;</span>
    ...
<span class="nt">&lt;/record&gt;</span>
</pre></div>
</div>
</section><section id="inheriting-xml"><h4 >Наследование XML</h4><p >XML-идентификаторы наследующих представлений должны использовать тот же идентификатор, что и исходная запись. Это помогает найти все наследство с первого взгляда. Поскольку конечные идентификаторы Xml имеют префикс модуля, который их создает, перекрытия нет.</p><p >Именование должно содержать суффикс `` .inherit. {Details} <a href="#id1"><span id="id2" class="problematic">``</span></a>, чтобы облегчить понимание цели переопределения при взгляде на его имя.</p><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;record</span> <span class="na">id=</span><span class="s">&quot;model_view_form&quot;</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>model.view.form.inherit.module2<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;inherit_id&quot;</span> <span class="na">ref=</span><span class="s">&quot;module1.model_view_form&quot;</span><span class="nt">/&gt;</span>
    ...
<span class="nt">&lt;/record&gt;</span>
</pre></div>
</div>
<p >Новые первичные представления не требуют суффикса наследования, поскольку это новые записи, основанные на первом.</p><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;record</span> <span class="na">id=</span><span class="s">&quot;module2.model_view_form&quot;</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>model.view.form.module2<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;inherit_id&quot;</span> <span class="na">ref=</span><span class="s">&quot;module1.model_view_form&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;mode&quot;</span><span class="nt">&gt;</span>primary<span class="nt">&lt;/field&gt;</span>
    ...
<span class="nt">&lt;/record&gt;</span>
</pre></div>
</div>
</section><section id="python"><i id="reference-guidelines-python"></i><h2 >питон</h2></section><section id="pep8-options"><h3 >Варианты PEP8</h3><p >Использование линтера может помочь показать синтаксические и семантические предупреждения или ошибки. Исходный код Odoo пытается соответствовать стандарту Python, но некоторые из них можно игнорировать.</p><ul ><li >E501: слишком длинная линия</li><li >E301: ожидается 1 пустая строка, найдено 0</li><li >E302: ожидается 2 пустых строки, найдено 1</li></ul></section><section id="imports"><h3 >импорт</h3><p >Импорт упорядочен как</p><ol ><li >Внешние библиотеки (по одной на строку, отсортированные и разбитые в python stdlib)</li><li >Импорт `` odoo``</li><li >Импорт из модулей Odoo (редко и только при необходимости)</li></ol><p >Внутри этих 3 групп импортированные строки отсортированы по алфавиту.</p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># 1 : imports of python lib</span>
<span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="c1"># 2 : imports of odoo</span>
<span class="kn">import</span> <span class="nn">odoo</span>
<span class="kn">from</span> <span class="nn">odoo</span> <span class="kn">import</span> <span class="n">api</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">_</span> <span class="c1"># alphabetically ordered</span>
<span class="kn">from</span> <span class="nn">odoo.tools.safe_eval</span> <span class="kn">import</span> <span class="n">safe_eval</span> <span class="k">as</span> <span class="nb">eval</span>
<span class="c1"># 3 : imports from odoo addons</span>
<span class="kn">from</span> <span class="nn">odoo.addons.website.models.website</span> <span class="kn">import</span> <span class="n">slug</span>
<span class="kn">from</span> <span class="nn">odoo.addons.web.controllers.main</span> <span class="kn">import</span> <span class="n">login_redirect</span>
</pre></div>
</div>
</section><section id="idiomatics-of-programming-python"><h3 >Идиоматика программирования (Python)</h3><ul ><li >Каждый файл Python должен иметь `` # - * - coding: utf-8 - * - `` в качестве первой строки.</li><li >Всегда отдавайте предпочтение * читабельности <a href="#id1"><span id="id2" class="problematic">*</span></a>, а не * краткости * или использованию языковых функций или идиом.</li><li >Не используйте `` .clone () ``</li></ul><div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># bad</span>
<span class="n">new_dict</span> <span class="o">=</span> <span class="n">my_dict</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
<span class="n">new_list</span> <span class="o">=</span> <span class="n">old_list</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
<span class="c1"># good</span>
<span class="n">new_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">my_dict</span><span class="p">)</span>
<span class="n">new_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">old_list</span><span class="p">)</span>
</pre></div>
</div>
<ul ><li >Словарь Python: создание и обновление</li></ul><div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># -- creation empty dict</span>
<span class="n">my_dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">my_dict2</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

<span class="c1"># -- creation with values</span>
<span class="c1"># bad</span>
<span class="n">my_dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">my_dict</span><span class="p">[</span><span class="s1">&#39;foo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">my_dict</span><span class="p">[</span><span class="s1">&#39;bar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span>
<span class="c1"># good</span>
<span class="n">my_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;foo&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span>

<span class="c1"># -- update dict</span>
<span class="c1"># bad</span>
<span class="n">my_dict</span><span class="p">[</span><span class="s1">&#39;foo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">my_dict</span><span class="p">[</span><span class="s1">&#39;bar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">my_dict</span><span class="p">[</span><span class="s1">&#39;baz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
<span class="c1"># good</span>
<span class="n">my_dict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">foo</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">bar</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">baz</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">my_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">my_dict</span><span class="p">,</span> <span class="o">**</span><span class="n">my_dict2</span><span class="p">)</span>
</pre></div>
</div>
<ul ><li >Используйте значимые имена переменных / классов / методов</li><li >Бесполезная переменная: временные переменные могут сделать код более понятным, присваивая имена объектам, но это не значит, что вы должны постоянно создавать временные переменные:</li></ul><div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># pointless</span>
<span class="n">schema</span> <span class="o">=</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;schema&#39;</span><span class="p">]</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;schema&#39;</span><span class="p">:</span> <span class="n">schema</span><span class="p">}</span>
<span class="c1"># simpler</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;schema&#39;</span><span class="p">:</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;schema&#39;</span><span class="p">]}</span>
</pre></div>
</div>
<ul ><li >Несколько точек возврата в порядке, когда они проще</li></ul><div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># a bit complex and with a redundant temp variable</span>
<span class="k">def</span> <span class="nf">axes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span> <span class="o">==</span> <span class="nb">type</span><span class="p">([]):</span>
                <span class="n">axes</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
                <span class="n">axes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">axes</span>

 <span class="c1"># clearer</span>
<span class="k">def</span> <span class="nf">axes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span> <span class="o">==</span> <span class="nb">type</span><span class="p">([]):</span>
                <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span> <span class="c1"># clone the axis</span>
        <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="c1"># single-element list</span>
</pre></div>
</div>
<ul ><li >Знайте свои встроенные функции: по крайней мере, вы должны иметь общее представление обо всех встроенных функциях Python (<a href="http://docs.python.org/library/functions.html" class="external reference">http://docs.python.org/library/functions.html</a>)</li></ul><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">value</span> <span class="o">=</span> <span class="n">my_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="c1"># very very redundant</span>
<span class="n">value</span> <span class="o">=</span> <span class="n">my_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">)</span> <span class="c1"># good</span>
</pre></div>
</div>
<p >Кроме того, `` if 'key' в my_dict`` и `` if my_dict.get ('key') `` имеют совершенно другое значение, убедитесь, что вы используете правильный.</p><ul ><li >Изучите понимание списка: используйте понимание списка, понимание слова и базовые манипуляции с использованием `` map``, `` filter``, `` sum``, … Они делают код более легким для чтения.</li></ul><div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># not very good</span>
<span class="n">cube</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
        <span class="n">cube</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span><span class="n">i</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]))</span>
<span class="c1"># better</span>
<span class="n">cube</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span> <span class="n">i</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">res</span><span class="p">]</span>
</pre></div>
</div>
<ul ><li >Коллекции также являются логическими значениями: в python многие объекты имеют значение «boolean-ish» при оценке в логическом контексте (например, if). Среди них есть коллекции (списки, сообщения, наборы и т. Д.), Которые являются «ложными», когда они пустые, и «правдивыми», когда содержат элементы:</li></ul><div class="highlight-python"><div class="highlight"><pre><span></span><span class="nb">bool</span><span class="p">([])</span> <span class="ow">is</span> <span class="kc">False</span>
<span class="nb">bool</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span> <span class="ow">is</span> <span class="kc">True</span>
<span class="nb">bool</span><span class="p">([</span><span class="kc">False</span><span class="p">])</span> <span class="ow">is</span> <span class="kc">True</span>
</pre></div>
</div>
<p >Таким образом, вы можете написать `` if some_collection: `` вместо `` if len (some_collection): <a href="#id1"><span id="id2" class="problematic">``</span></a>.</p><ul ><li >Итерировать на итерации</li></ul><div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># creates a temporary list and looks bar</span>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">my_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="s2">&quot;do something...&quot;</span>
<span class="c1"># better</span>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">my_dict</span><span class="p">:</span>
        <span class="s2">&quot;do something...&quot;</span>
<span class="c1"># accessing the key,value pair</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">my_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="s2">&quot;do something...&quot;</span>
</pre></div>
</div>
<ul ><li >Используйте dict.setdefault</li></ul><div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># longer.. harder to read</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">iterable</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">element</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
        <span class="n">values</span><span class="p">[</span><span class="n">element</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">values</span><span class="p">[</span><span class="n">element</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">other_value</span><span class="p">)</span>

<span class="c1"># better.. use dict.setdefault method</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">iterable</span><span class="p">:</span>
    <span class="n">values</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">other_value</span><span class="p">)</span>
</pre></div>
</div>
<ul ><li >Как хороший разработчик, документируйте свой код (документация по методам, простые комментарии для хитрой части кода)</li><li >В дополнение к этим рекомендациям, вы также можете найти следующую ссылку интересной: <a href="http://python.net/~goodger/projects/pycon/2007/idiomatic/handout.html" class="external reference">http://python.net/~goodger/projects/pycon/2007/idiomatic/handout.html</a> (немного устаревшая, но весьма актуальная)</li></ul></section><section id="programming-in-odoo"><h3 >Программирование в Odoo</h3><ul ><li >Избегайте создания генераторов и декораторов: используйте только те, которые предоставляются API Odoo.</li><li >Как и в python, используйте `` фильтрованный``, `` маппированный``, `` sorted``, … методы, чтобы упростить чтение кода и производительность.</li></ul></section><section id="make-your-method-work-in-batch"><h4 >Сделайте так, чтобы ваш метод работал в пакетном режиме</h4><p >При добавлении функции убедитесь, что она может обрабатывать несколько записей, итерируя себя для обработки каждой записи.</p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_method</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
        <span class="n">record</span><span class="o">.</span><span class="n">do_cool_stuff</span><span class="p">()</span>
</pre></div>
</div>
<p >Из-за проблем с производительностью при разработке «кнопки stat» (например) не выполняйте «поиск» или «поиск по количеству» в цикле. Рекомендуется использовать метод `` read_group``, чтобы вычислить все значения только в одном запросе.</p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">_compute_equipment_count</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="sd">&quot;&quot;&quot; Count the number of equipement per category &quot;&quot;&quot;</span>
    <span class="n">equipment_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="p">[</span><span class="s1">&#39;hr.equipment&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">read_group</span><span class="p">([(</span><span class="s1">&#39;category_id&#39;</span><span class="p">,</span> <span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ids</span><span class="p">)],</span> <span class="p">[</span><span class="s1">&#39;category_id&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;category_id&#39;</span><span class="p">])</span>
    <span class="n">mapped_data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;category_id&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">m</span><span class="p">[</span><span class="s1">&#39;category_id_count&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">equipment_data</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">category</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
        <span class="n">category</span><span class="o">.</span><span class="n">equipment_count</span> <span class="o">=</span> <span class="n">mapped_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">category</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</section><section id="propagate-the-context"><h4 >Распространять контекст</h4><p >Контекст - это `` frozendict``, который нельзя изменить. Для вызова метода с другим контекстом должен использоваться метод `` with_context``:</p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">records</span><span class="o">.</span><span class="n">with_context</span><span class="p">(</span><span class="n">new_context</span><span class="p">)</span><span class="o">.</span><span class="n">do_stuff</span><span class="p">()</span> <span class="c1"># all the context is replaced</span>
<span class="n">records</span><span class="o">.</span><span class="n">with_context</span><span class="p">(</span><span class="o">**</span><span class="n">additionnal_context</span><span class="p">)</span><span class="o">.</span><span class="n">do_other_stuff</span><span class="p">()</span> <span class="c1"># additionnal_context values override native context ones</span>
</pre></div>
</div>
<div role="alert" class="alert alert-warning"><h3 class="alert-title">Предупреждение</h3><p >Передача параметра в контексте может иметь опасные побочные эффекты.</p><p >Поскольку значения распространяются автоматически, может возникнуть непредвиденное поведение. Вызов метода `` create () `` модели с ключом * default_my_field * в контексте установит значение по умолчанию * my_field * для соответствующей модели. Но если во время этого создания будут созданы другие объекты (такие как sale.order.line, при создании sale.order), имеющие имя поля * my_field <a href="#id1"><span id="id2" class="problematic">*</span></a>, их значение по умолчанию также будет установлено.</p></div><p >Если вам необходимо создать ключевой контекст, влияющий на поведение какого-либо объекта, выберите подходящее имя и, в конечном итоге, добавьте его к имени модуля, чтобы изолировать его влияние. Хорошим примером являются ключи модуля `` mail``: * mail_create_nosubscribe <a href="#id1"><span id="id2" class="problematic">*</span></a>, * mail_notrack <a href="#id3"><span id="id4" class="problematic">*</span></a>, * mail_notify_user_signature <a href="#id5"><span id="id6" class="problematic">*</span></a>, …</p></section><section id="do-not-bypass-the-orm"><h4 >Не обходите ОРМ</h4><p >Вы никогда не должны использовать курсор базы данных напрямую, когда ORM может сделать то же самое! Тем самым вы обходите все функции ORM, возможно, транзакции, права доступа и так далее.</p><p >И есть вероятность, что вы также затрудняете чтение кода и, вероятно, делаете его менее безопасным.</p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># very very wrong</span>
<span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">cr</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;SELECT id FROM auction_lots WHERE auction_id in (&#39;</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">ids</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;) AND state=</span><span class="si">%s</span><span class="s1"> AND obj_price &gt; 0&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;draft&#39;</span><span class="p">,))</span>
<span class="n">auction_lots_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">cr</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()]</span>

<span class="c1"># no injection, but still wrong</span>
<span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">cr</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;SELECT id FROM auction_lots WHERE auction_id in </span><span class="si">%s</span><span class="s1"> &#39;</span>\
           <span class="s1">&#39;AND state=</span><span class="si">%s</span><span class="s1"> AND obj_price &gt; 0&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">ids</span><span class="p">),</span> <span class="s1">&#39;draft&#39;</span><span class="p">,))</span>
<span class="n">auction_lots_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">cr</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()]</span>

<span class="c1"># better</span>
<span class="n">auction_lots_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">search</span><span class="p">([(</span><span class="s1">&#39;auction_id&#39;</span><span class="p">,</span><span class="s1">&#39;in&#39;</span><span class="p">,</span><span class="n">ids</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;state&#39;</span><span class="p">,</span><span class="s1">&#39;=&#39;</span><span class="p">,</span><span class="s1">&#39;draft&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;obj_price&#39;</span><span class="p">,</span><span class="s1">&#39;&gt;&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
</pre></div>
</div>
</section><section id="no-sql-injections-please"><h4 >Нет SQL-инъекций, пожалуйста!</h4><p >Необходимо соблюдать осторожность, чтобы не вводить уязвимости SQL-инъекций при использовании ручных SQL-запросов. Уязвимость возникает, когда пользовательский ввод либо неправильно фильтруется, либо неправильно цитируется, что позволяет злоумышленнику вводить нежелательные предложения в запрос SQL (например, обходить фильтры или выполнять команды UPDATE или DELETE).</p><p >Лучший способ быть безопасным - никогда НИКОГДА не использовать конкатенацию строк Python (+) или интерполяцию строковых параметров (%) для передачи переменных в строку запроса SQL.</p><p >Вторая причина, которая почти так же важна, заключается в том, что именно уровень абстракции базы данных (psycopg2) решает, как форматировать параметры запроса, а не свою работу! Например, psycopg2 знает, что когда вы передаете список значений, он должен отформатировать их в виде списка через запятую, заключенного в скобки!</p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># the following is very bad:</span>
<span class="c1">#   - it&#39;s a SQL injection vulnerability</span>
<span class="c1">#   - it&#39;s unreadable</span>
<span class="c1">#   - it&#39;s not your job to format the list of ids</span>
<span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">cr</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;SELECT distinct child_id FROM account_account_consol_rel &#39;</span> <span class="o">+</span>
           <span class="s1">&#39;WHERE parent_id IN (&#39;</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">ids</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;)&#39;</span><span class="p">)</span>

<span class="c1"># better</span>
<span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">cr</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;SELECT DISTINCT child_id &#39;</span>\
           <span class="s1">&#39;FROM account_account_consol_rel &#39;</span>\
           <span class="s1">&#39;WHERE parent_id IN </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span>
           <span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">ids</span><span class="p">),))</span>
</pre></div>
</div>
<p >Это очень важно, поэтому, пожалуйста, будьте осторожны при рефакторинге, и самое главное, не копируйте эти шаблоны!</p><p >Вот памятный пример, который поможет вам вспомнить, в чем проблема (но не копируйте код там). Прежде чем продолжить, обязательно прочитайте онлайн-документацию по pyscopg2, чтобы научиться правильно ее использовать:</p><ul ><li >Проблема с параметрами запроса (<a href="http://initd.org/psycopg/docs/usage.html#the-problem-with-the-query-parameters" class="external reference">http://initd.org/psycopg/docs/usage.html#the-problem-with-the-query-parameters</a>)</li><li >Как передать параметры с помощью psycopg2 (<a href="http://initd.org/psycopg/docs/usage.html#passing-parameters-to-sql-queries" class="external reference">http://initd.org/psycopg/docs/usage.html#passing-parameters-to-sql-queries</a>)</li><li >Расширенные типы параметров (<a href="http://initd.org/psycopg/docs/usage.html#adaptation-of-python-values-to-sql-types" class="external reference">http://initd.org/psycopg/docs/usage.html#adaptation-of-python-values-to-sql-types</a>)</li></ul></section><section id="think-extendable"><h4 >Думайте расширяемый</h4><p >Функции и методы не должны содержать слишком много логики: наличие большого количества маленьких и простых методов более целесообразно, чем использование нескольких больших и сложных методов. Хорошее практическое правило - разделять метод, как только он несет более одной ответственности (см. <a href="Http://en.wikipedia.org/wiki/Single_responsibility_principle" class="external reference">Http://en.wikipedia.org/wiki/Single_responsibility_principle</a>).</p><p >Следует избегать жесткого кодирования бизнес-логики в методе, поскольку она не позволяет легко расширяться подмодулем.</p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># do not do this</span>
<span class="c1"># modifying the domain or criteria implies overriding whole method</span>
<span class="k">def</span> <span class="nf">action</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="o">...</span>  <span class="c1"># long method</span>
    <span class="n">partners</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="p">[</span><span class="s1">&#39;res.partner&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">complex_domain</span><span class="p">)</span>
    <span class="n">emails</span> <span class="o">=</span> <span class="n">partners</span><span class="o">.</span><span class="n">filtered</span><span class="p">(</span><span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="n">arbitrary_criteria</span><span class="p">)</span><span class="o">.</span><span class="n">mapped</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">)</span>

<span class="c1"># better but do not do this either</span>
<span class="c1"># modifying the logic forces to duplicate some parts of the code</span>
<span class="k">def</span> <span class="nf">action</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="o">...</span>
    <span class="n">partners</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_partners</span><span class="p">()</span>
    <span class="n">emails</span> <span class="o">=</span> <span class="n">partners</span><span class="o">.</span><span class="n">_get_emails</span><span class="p">()</span>

<span class="c1"># better</span>
<span class="c1"># minimum override</span>
<span class="k">def</span> <span class="nf">action</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="o">...</span>
    <span class="n">partners</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="p">[</span><span class="s1">&#39;res.partner&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_partner_domain</span><span class="p">())</span>
    <span class="n">emails</span> <span class="o">=</span> <span class="n">partners</span><span class="o">.</span><span class="n">filtered</span><span class="p">(</span><span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">_filter_partners</span><span class="p">())</span><span class="o">.</span><span class="n">mapped</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p >Приведенный выше код является чрезмерно расширяемым ради примера, но читабельность должна быть принята во внимание, и должен быть достигнут компромисс.</p><p >Кроме того, назовите свои функции соответственно: маленькие и правильно названные функции являются отправной точкой читаемого / поддерживаемого кода и более плотной документации.</p><p >Эта рекомендация также актуальна для классов, файлов, модулей и пакетов. (Смотрите также <a href="http://en.wikipedia.org/wiki/Cyclomatic_complexity" class="external reference">http://en.wikipedia.org/wiki/Cyclomatic_complexity</a>)</p></section><section id="never-commit-the-transaction"><h4 >Никогда не совершайте транзакцию</h4><p >Платформа Odoo отвечает за обеспечение транзакционного контекста для всех вызовов RPC. Принцип заключается в том, что новый курсор базы данных открывается в начале каждого вызова RPC и фиксируется после его возврата, непосредственно перед передачей ответа клиенту RPC, примерно так:</p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db_name</span><span class="p">,</span> <span class="n">uid</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="n">db</span><span class="p">,</span> <span class="n">pool</span> <span class="o">=</span> <span class="n">pooler</span><span class="o">.</span><span class="n">get_db_and_pool</span><span class="p">(</span><span class="n">db_name</span><span class="p">)</span>
    <span class="c1"># create transaction cursor</span>
    <span class="n">cr</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">execute_cr</span><span class="p">(</span><span class="n">cr</span><span class="p">,</span> <span class="n">uid</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="n">cr</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span> <span class="c1"># all good, we commit</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="n">cr</span><span class="o">.</span><span class="n">rollback</span><span class="p">()</span> <span class="c1"># error, rollback everything atomically</span>
        <span class="k">raise</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="n">cr</span><span class="o">.</span><span class="n">close</span><span class="p">()</span> <span class="c1"># always close cursor opened manually</span>
    <span class="k">return</span> <span class="n">res</span>
</pre></div>
</div>
<p >Если во время выполнения вызова RPC возникает какая-либо ошибка, транзакция откатывается атомарно, сохраняя состояние системы.</p><p >Аналогично, система также предоставляет выделенную транзакцию во время выполнения наборов тестов, поэтому ее можно откатить или нет, в зависимости от параметров запуска сервера.</p><p >Следствием этого является то, что если вы вручную вызываете `` cr.commit () `` в любом месте, существует очень высокая вероятность того, что вы сломаете систему различными способами, потому что вы будете вызывать частичные коммиты и, таким образом, частичные и нечистые откаты, вызывая среди другие:</p><ol ><li >противоречивые бизнес-данные, как правило, потеря данных</li><li >десинхронизация рабочего процесса, документы застряли навсегда</li><li >тесты, которые не могут быть откатлены без ошибок, и начнут загрязнять базу данных, вызывая ошибку (это верно, даже если во время транзакции ошибки не возникало)</li></ol><dl ><dt >Вот очень простое правило:</dt><dd ><p >Вы должны ** НИКОГДА ** не вызывать `` cr.commit () `` себя, ** ЕСЛИ НЕ ** вы явно создали свой собственный курсор базы данных! И ситуации, когда вам нужно это сделать, исключительны!</p><p >И, кстати, если вы создали собственный курсор, то вам нужно обрабатывать ошибки и правильно выполнять откат, а также правильно закрывать курсор, когда вы закончите с ним.</p></dd></dl><p >И вопреки распространенному мнению, вам даже не нужно вызывать `` cr.commit () `` в следующих ситуациях: - в методе `` _auto_init () `` объекта * models.Model <a href="#id1"><span id="id2" class="problematic">*</span></a>: это принято забота о методе инициализации аддонов или транзакции ORM при создании пользовательских моделей - в отчетах: `` commit () `` также обрабатывается фреймворком, поэтому вы можете обновить базу данных даже из отчета - внутри * models.Transient * методы: эти методы вызываются точно так же, как и обычные * models.Model <a href="#id3"><span id="id4" class="problematic">*</span></a>, внутри транзакции и с соответствующим `` cr.commit () / rollback () `` в конце - и т. д. (см. общее правило) выше, если у вас есть сомнения!)</p><p >Все вызовы `` cr.commit () `` вне рамок сервера теперь должны иметь ** явный комментарий <a href="#id1"><span id="id2" class="problematic">**</span></a>, объясняющий, почему они абсолютно необходимы, почему они действительно правильные и почему они не нарушают транзакции. В противном случае они могут и будут удалены!</p></section><section id="use-translation-method-correctly"><h4 >Используйте метод перевода правильно</h4><p >Odoo использует GetText-подобный метод с именем «underscore» `` _ () <a href="#id1"><span id="id2" class="problematic">``</span></a>, чтобы указать, что статическая строка, используемая в коде, должна быть переведена во время выполнения с использованием языка контекста. Этот псевдо-метод доступен в вашем коде путем импорта следующим образом:</p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">odoo</span> <span class="kn">import</span> <span class="n">_</span>
</pre></div>
</div>
<p >При его использовании необходимо соблюдать несколько очень важных правил, чтобы он работал и не заполнял переводы ненужным мусором.</p><p >По сути, этот метод следует использовать только для статических строк, написанных вручную в коде, он не будет работать для перевода значений полей, таких как имена продуктов и т. Д. Это должно быть сделано вместо этого с использованием флага перевода в соответствующем поле.</p><p >Правило очень простое: вызовы метода подчеркивания должны всегда иметь форму `` _ ('литерал' ') `` и ничего более:</p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># good: plain strings</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s1">&#39;This record is locked!&#39;</span><span class="p">)</span>

<span class="c1"># good: strings with formatting patterns included</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s1">&#39;Record </span><span class="si">%s</span><span class="s1"> cannot be modified!&#39;</span><span class="p">)</span> <span class="o">%</span> <span class="n">record</span>

<span class="c1"># ok too: multi-line literal strings</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;This is a bad multiline example</span>
<span class="s2">             about record </span><span class="si">%s</span><span class="s2">!&quot;&quot;&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="n">record</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s1">&#39;Record </span><span class="si">%s</span><span class="s1"> cannot be modified&#39;</span> \
          <span class="s1">&#39;after being validated!&#39;</span><span class="p">)</span> <span class="o">%</span> <span class="n">record</span>

<span class="c1"># bad: tries to translate after string formatting</span>
<span class="c1">#      (pay attention to brackets!)</span>
<span class="c1"># This does NOT work and messes up the translations!</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s1">&#39;Record </span><span class="si">%s</span><span class="s1"> cannot be modified!&#39;</span> <span class="o">%</span> <span class="n">record</span><span class="p">)</span>

<span class="c1"># bad: dynamic string, string concatenation, etc are forbidden!</span>
<span class="c1"># This does NOT work and messes up the translations!</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="n">que_rec</span><span class="p">[</span><span class="s1">&#39;question&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;&#39; </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># bad: field values are automatically translated by the framework</span>
<span class="c1"># This is useless and will not work the way you think:</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot;Product </span><span class="si">%s</span><span class="s2"> is out of stock!&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="n">_</span><span class="p">(</span><span class="n">product</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="c1"># and the following will of course not work as already explained:</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot;Product </span><span class="si">%s</span><span class="s2"> is out of stock!&quot;</span> <span class="o">%</span> <span class="n">product</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<span class="c1"># bad: field values are automatically translated by the framework</span>
<span class="c1"># This is useless and will not work the way you think:</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot;Product </span><span class="si">%s</span><span class="s2"> is not available!&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="n">_</span><span class="p">(</span><span class="n">product</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="c1"># and the following will of course not work as already explained:</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot;Product </span><span class="si">%s</span><span class="s2"> is not available!&quot;</span> <span class="o">%</span> <span class="n">product</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<span class="c1"># Instead you can do the following and everything will be translated,</span>
<span class="c1"># including the product name if its field definition has the</span>
<span class="c1"># translate flag properly set:</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot;Product </span><span class="si">%s</span><span class="s2"> is not available!&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="n">product</span><span class="o">.</span><span class="n">name</span>
</pre></div>
</div>
<p >Также имейте в виду, что переводчикам придется работать с литеральными значениями, которые передаются в функцию подчеркивания, поэтому постарайтесь упростить их понимание и свести к минимуму ложные символы и форматирование. Переводчики должны знать, что шаблоны форматирования, такие как% s или% d, переводы строк и т. Д., Должны быть сохранены, но важно использовать их разумным и очевидным образом:</p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Bad: makes the translations hard to work with</span>
<span class="n">error</span> <span class="o">=</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="n">question</span> <span class="o">+</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot;&#39; </span><span class="se">\n</span><span class="s2">Please enter an integer value &quot;</span><span class="p">)</span>

<span class="c1"># Better (pay attention to position of the brackets too!)</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot;Answer to question </span><span class="si">%s</span><span class="s2"> is not valid.</span><span class="se">\n</span><span class="s2">&quot;</span> \
          <span class="s2">&quot;Please enter an integer value.&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="n">question</span>
</pre></div>
</div>
<p >В общем случае в Odoo при работе со строками предпочитайте <a href="#id1"><span id="id2" class="problematic">``</span></a>% `` вместо `` .format () `` (когда в строке следует заменить только одну переменную) и предпочитайте <a href="#id3"><span id="id4" class="problematic">``</span></a>% (varname) `` вместо позиции ( когда несколько переменных должны быть заменены). Это облегчает перевод для сообщества переводчиков.</p></section><section id="symbols-and-conventions"><h3 >Символы и условные обозначения</h3><ul ><li ><dl ><dt >Название модели (с использованием точечной нотации, префикса по имени модуля):</dt><dd ><ul ><li >При определении модели Odoo: используйте единственную форму имени (* res.partner * и * sale.order * вместо * res.partnerS * и * saleS.orderS <a href="#id1"><span id="id2" class="problematic">*</span></a>)</li><li >При определении Odoo Transient (мастер): используйте `` &lt;related_base_model&gt; , &lt;action&gt; `` where * related_base_model * - базовая модель (определенная в * models / <a href="#id1"><span id="id2" class="problematic">*</span></a>), связанная с переходным процессом, а * action * - краткое имя того, что делает переходный процесс. Избегайте слова <code >волшебник</code>. Например: `` account.invoice.make``, `` project.task.delegate.batch``, …</li><li >При определении модели * report * (SQL views ei): используйте `` &lt;related_base_model&gt; .report. &lt;action&gt; <a href="#id1"><span id="id2" class="problematic">``</span></a>, основанный на соглашении о переходных процессах.</li></ul></dd></dl></li><li >Класс Odoo Python: используйте camelcase (объектно-ориентированный стиль).</li></ul><div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">AccountInvoice</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
<ul ><li ><dl ><dt >Имя переменной:</dt><dd ><ul ><li >использовать верблюд для переменной модели</li><li >используйте подчеркивание в нижнем регистре для общей переменной.</li><li >добавьте суффикс имени вашей переменной * _id * или * _ids <a href="#id1"><span id="id2" class="problematic">*</span></a>, если он содержит идентификатор записи или список идентификаторов. Не используйте `` partner_id`` для хранения записи res.partner</li></ul></dd></dl></li></ul><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">Partner</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="p">[</span><span class="s1">&#39;res.partner&#39;</span><span class="p">]</span>
<span class="n">partners</span> <span class="o">=</span> <span class="n">Partner</span><span class="o">.</span><span class="n">browse</span><span class="p">(</span><span class="n">ids</span><span class="p">)</span>
<span class="n">partner_id</span> <span class="o">=</span> <span class="n">partners</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">id</span>
</pre></div>
</div>
<ul ><li >Поля `` One2Many`` и `` Many2Many`` всегда должны содержать * _ids * в качестве суффикса (пример: sale_order_line_ids)</li><li >`` Many2One`` поля должны иметь * _id * в качестве суффикса (пример: partner_id, user_id, …)</li><li ><dl ><dt >Соглашения о методах</dt><dd ><ul ><li >Поле вычисления: шаблон метода вычисления - * _compute_ &lt;field_name&gt; *</li><li >Метод поиска: шаблон метода поиска - * _search_ &lt;field_name&gt; *</li><li >Метод по умолчанию: шаблон метода по умолчанию * _default_ &lt;field_name&gt; *</li><li >Метод выбора: шаблон метода выбора * _selection_ &lt;field_name&gt; *</li><li >Метод Onchange: шаблон метода onchange: * _onchange_ &lt;field_name&gt; *</li><li >Метод ограничения: шаблон метода ограничения - * _check_ &lt;constraint_name&gt; *</li><li >Метод действия: метод действия объекта имеет префикс * <a href="#id3"><span id="id4" class="problematic">action_</span></a> <a href="#id1"><span id="id2" class="problematic">*</span></a>. Поскольку он использует только одну запись, добавьте `` self.ensure_one () `` в начале метода.</li></ul></dd></dl></li><li ><dl ><dt >В атрибуте Model порядок должен быть</dt><dd ><ol ><li >Закрытые атрибуты (`` _name``, `` _description``, `` _inherit``, …)</li><li >Метод по умолчанию и `` _default_get``</li><li >Полевые объявления</li><li >Вычислять, инвертировать и искать методы в том же порядке, что и объявление поля</li><li >Метод выбора (методы, используемые для возврата вычисленных значений для полей выбора)</li><li >Методы ограничений (`` @ api.constrains``) и методы onchange (`` @ api.onchange``)</li><li >Методы CRUD (переопределения ORM)</li><li >Методы действия</li><li >И, наконец, другие методы ведения бизнеса.</li></ol></dd></dl></li></ul><div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Event</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="c1"># Private attributes</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s1">&#39;event.event&#39;</span>
    <span class="n">_description</span> <span class="o">=</span> <span class="s1">&#39;Event&#39;</span>

    <span class="c1"># Default methods</span>
    <span class="k">def</span> <span class="nf">_default_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="o">...</span>

    <span class="c1"># Fields declaration</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Char</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">_default_name</span><span class="p">)</span>
    <span class="n">seats_reserved</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Integer</span><span class="p">(</span><span class="n">oldname</span><span class="o">=</span><span class="s1">&#39;register_current&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s1">&#39;Reserved Seats&#39;</span><span class="p">,</span>
        <span class="n">store</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">readonly</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">compute</span><span class="o">=</span><span class="s1">&#39;_compute_seats&#39;</span><span class="p">)</span>
    <span class="n">seats_available</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Integer</span><span class="p">(</span><span class="n">oldname</span><span class="o">=</span><span class="s1">&#39;register_avail&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s1">&#39;Available Seats&#39;</span><span class="p">,</span>
        <span class="n">store</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">readonly</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">compute</span><span class="o">=</span><span class="s1">&#39;_compute_seats&#39;</span><span class="p">)</span>
    <span class="n">price</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Integer</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="s1">&#39;Price&#39;</span><span class="p">)</span>
    <span class="n">event_type</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Selection</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="s2">&quot;Type&quot;</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="s1">&#39;_selection_type&#39;</span><span class="p">)</span>

    <span class="c1"># compute and search fields, in the same order of fields declaration</span>
    <span class="nd">@api</span><span class="o">.</span><span class="n">depends</span><span class="p">(</span><span class="s1">&#39;seats_max&#39;</span><span class="p">,</span> <span class="s1">&#39;registration_ids.state&#39;</span><span class="p">,</span> <span class="s1">&#39;registration_ids.nb_register&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_compute_seats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="o">...</span>

    <span class="nd">@api</span><span class="o">.</span><span class="n">model</span>
    <span class="k">def</span> <span class="nf">_selection_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="c1"># Constraints and onchanges</span>
    <span class="nd">@api</span><span class="o">.</span><span class="n">constrains</span><span class="p">(</span><span class="s1">&#39;seats_max&#39;</span><span class="p">,</span> <span class="s1">&#39;seats_available&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_check_seats_limit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="o">...</span>

    <span class="nd">@api</span><span class="o">.</span><span class="n">onchange</span><span class="p">(</span><span class="s1">&#39;date_begin&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_onchange_date_begin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="o">...</span>

    <span class="c1"># CRUD methods (and name_get, name_search, ...) overrides</span>
    <span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="o">...</span>

    <span class="c1"># Action methods</span>
    <span class="k">def</span> <span class="nf">action_validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ensure_one</span><span class="p">()</span>
        <span class="o">...</span>

    <span class="c1"># Business methods</span>
    <span class="k">def</span> <span class="nf">mail_user_confirm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="o">...</span>
</pre></div>
</div>
</section><section id="javascript-and-css"><i id="reference-guidelines-js"></i><h2 >Javascript и CSS</h2></section><section id="static-files-organization"><h3 >Организация статических файлов</h3><p >У аддонов Odoo есть некоторые соглашения о том, как структурировать различные файлы. Мы объясняем здесь более подробно, как веб-ресурсы должны быть организованы.</p><p >Первое, что нужно знать, это то, что сервер Odoo будет обслуживать (статически) все файлы, находящиеся в папке * static / <em >, но с префиксом имени дополнения. Так, например, если файл находится в * addons / web / static / src / js / some_file.js *, то он будет статически доступен по адресу * your-odoo-server.com / web / static / src /js/some_file.js</em></p><p >Соглашение состоит в том, чтобы организовать код в соответствии со следующей структурой:</p><ul ><li ><p ><em >static</em>: all static files in general</p><ul ><li ><em >static/lib</em>: this is the place where js libs should be located, in a sub folder.
So, for example, all files from the <em >jquery</em> library are in <em >addons/web/static/lib/jquery</em></li><li ><p ><em >static/src</em>: the generic static source code folder</p><ul ><li ><em >static/src/css</em>: all css files</li><li ><em >static/src/fonts</em></li><li ><em >static/src/img</em></li><li ><p ><em >static/src/js</em></p><ul ><li ><em >static/src/js/tours</em>: end user tour files (tutorials, not tests)</li></ul></li><li ><em >static/src/scss</em>: scss files</li><li ><em >static/src/xml</em>: all qweb templates that will be rendered in JS</li></ul></li><li ><p ><em >static/tests</em>: this is where we put all test related files.</p><ul ><li ><em >static/tests/tours</em>: this is where we put all tour test files (not tutorials).</li></ul></li></ul></li></ul></section><section id="javascript-coding-guidelines"><h3 >Руководство по кодированию Javascript</h3><ul ><li >`` используйте строгий; `` рекомендуется для всех файлов javascript</li><li >Используйте линтер (jshint, …)</li><li >Никогда не добавляйте уменьшенные библиотеки Javascript</li><li >Используйте camelcase для объявления класса</li></ul><p >Более точные рекомендации JS подробно описаны в <a href="https://github.com/odoo/odoo/wiki/Javascript-coding-guidelines" class="external reference">github wiki</a>. Вы также можете взглянуть на существующий API в Javascript, просмотрев ссылки на Javascript.</p></section><section id="css-coding-guidelines"><h3 >Руководство по кодированию CSS</h3><ul ><li >Префикс всех ваших классов с * <a href="#id5"><span id="id6" class="problematic">o_</span></a> &lt;module_name&gt; * где * имя_модуля * - это техническое имя модуля («продажа», «im_chat», …) или основной маршрут, зарезервированный модулем (в основном для модуля веб-сайта, то есть: «o_forum» для модуля * website_forum <a href="#id1"><span id="id2" class="problematic">*</span></a>) , Единственным исключением из этого правила является веб-клиент: он просто использует префикс * <a href="#id7"><span id="id8" class="problematic">o_</span></a> <a href="#id3"><span id="id4" class="problematic">*</span></a>.</li><li >Избегайте использования тега * id *</li><li >Используйте Bootstrap нативные классы</li><li >Используйте нижнее подчеркивание для обозначения класса</li></ul></section><section id="git"><i id="reference-guidelines-git"></i><h2 >Гит</h2></section><section id="configure-your-git"><h3 >Настройте свой мерзавец</h3><p >Исходя из опыта предков и устных традиций, следующие вещи имеют большое значение для того, чтобы сделать ваши коммиты более полезными:</p><ul ><li ><p >Обязательно укажите и user.email, и user.name в вашей локальной конфигурации git</p><div class="highlight-text"><div class="highlight"><pre><span></span>git config --global &lt;var&gt; &lt;value&gt;
</pre></div>
</div>
</li><li >Не забудьте добавить свое полное имя в свой профиль Github здесь. Пожалуйста, чувствуйте себя модно и добавьте свою команду, аватар, свою любимую цитату и еще много чего ;-)</li></ul></section><section id="commit-message-structure"><h3 >Зафиксировать структуру сообщения</h3><p >Сообщение коммита состоит из четырех частей: тега, модуля, краткого описания и полного описания. Попытайтесь следовать предпочтительной структуре ваших сообщений коммита</p><div class="highlight-text"><div class="highlight"><pre><span></span>[TAG] module: describe your change in a short sentence (ideally &lt; 50 chars)

Long version of the change description, including the rationale for the change,
or a summary of the feature being introduced.

Please spend a lot more time describing WHY the change is being done rather
than WHAT is being changed. This is usually easy to grasp by actually reading
the diff. WHAT should be explained only if there are technical choices
or decision involved. In that case explain WHY this decision was taken.

End the message with references, such as task or bug numbers, PR numbers, and
OPW tickets, following the suggested format:
task-123 (related to task)
Fixes #123  (close related issue on Github)
Closes #123  (close related PR on Github)
opw-123 (related to ticket)
</pre></div>
</div>
</section><section id="tag-and-module-name"><h3 >Тег и название модуля</h3><p >Теги используются для префикса вашего коммита. Они должны быть одним из следующих</p><ul ><li >** [FIX] ** для исправления ошибок: в основном используется в стабильной версии, но также действует, если вы исправляете недавнюю ошибку в версии для разработчиков;</li><li >** [REF] ** для рефакторинга: когда объект сильно переписан;</li><li >** [ДОБАВИТЬ] ** для добавления новых модулей;</li><li >** [REM] ** для удаления ресурсов: удаление мертвого кода, удаление представлений, удаление модулей, …;</li><li >** [REV] ** для отмены фиксации: если фиксация вызывает проблемы или нежелательна, она выполняется с помощью этого тега;</li><li >** [MOV] ** для перемещения файлов: используйте git move и не изменяйте содержимое перемещенного файла, в противном случае Git может потерять трек и историю файла; также используется при перемещении кода из одного файла в другой;</li><li >** [REL] ** для коммитов релиза: новые мажорные или минорные стабильные версии;</li><li >** [IMP] ** для улучшений: большинство изменений, внесенных в разрабатываемую версию, являются постепенными улучшениями, не связанными с другим тегом;</li><li >** [MERGE] ** для коммитов слияния: используется в прямом порте исправлений ошибок, но также как основной коммит для функции, включающей несколько отдельных коммитов;</li><li >** [CLA] ** для подписания Индивидуальной Лицензии Участника Odoo;</li><li >** [I18N] ** для изменений в файлах перевода;</li></ul><p >После тега следует измененное имя модуля. Используйте техническое имя, так как функциональное имя может меняться со временем. Если несколько модулей модифицированы, перечислите их или используйте различные, чтобы сказать, что это кросс-модули. Если это действительно не требуется или проще, избегайте модификации кода между несколькими модулями в одном коммите. Понимание истории модуля может стать затруднительным.</p></section><section id="commit-message-header"><h3 >Зафиксировать заголовок сообщения</h3><p >После тега и имени модуля следует значимый заголовок сообщения коммита. Это должно быть самоочевидным и включать причину изменения. Не используйте отдельные слова, такие как «исправление ошибок» или «улучшения». Попробуйте ограничить длину заголовка примерно до 50 символов для удобства чтения.</p><p >Заголовок сообщения коммита должен составлять правильное предложение после объединения с <code >, если применяется, этот коммит будет &lt;header&gt; ``. Например, `` [IMP] base: предотвращать архивирование пользователей, связанных с активными партнерами</code>, является правильным, поскольку оно делает правильное предложение <a href="#id1"><span id="id2" class="problematic">``</span></a>, если оно применяется, эта фиксация не позволит пользователям архивировать … <a href="#id3"><span id="id4" class="problematic">``</span></a>.</p></section><section id="commit-message-full-description"><h3 >Подтвердить сообщение полное описание</h3><p >В описании сообщения укажите часть кода, на которую повлияли ваши изменения (имя модуля, lib, трансверсальный объект, …) и описание изменений.</p><p >Сначала объясните, ПОЧЕМУ вы модифицируете код. Что важно, если кто-то вернется к вашему коммиту примерно через 4 десятилетия (или 3 дня), это то, почему вы это сделали. Это цель перемен.</p><p >То, что вы сделали, можно найти в самом коммите. Если были какие-то технические решения, было бы полезно объяснить это также в сообщении фиксации после почему. Для разработчиков Odoo R &amp;amp; D «команда ПО попросила меня сделать это», не вполне понятно почему, кстати.</p><p >Пожалуйста, избегайте коммитов, которые одновременно влияют на несколько модулей. Попробуйте разделить на разные коммиты, в которых затронутые модули разные. Будет полезно, если нам нужно отменить изменения в данном модуле отдельно.</p><p >Не стесняйтесь быть немного многословным. Большинство людей увидят только ваше сообщение о коммите и будут судить обо всем, что вы сделали в своей жизни, только на основании этих нескольких предложений. Никакого давления вообще.</p><p >** Вы тратите несколько часов, дней или недель, работая над значимыми функциями. Потратьте некоторое время, чтобы успокоиться и написать ясные и понятные сообщения о коммите. **</p><p >Если вы являетесь разработчиком Odoo R &amp;amp; D, ПОЧЕМУ должно быть целью задачи, над которой вы работаете. Полные спецификации составляют ядро сообщения коммита. ** Если вы работаете над задачей, которая не имеет цели и спецификаций, пожалуйста, перед тем как продолжить, проясните их. **</p><p >Наконец, вот несколько примеров правильных сообщений о коммите:</p><div class="highlight-text"><div class="highlight"><pre><span></span>[REF] models: use `parent_path` to implement parent_store

 This replaces the former modified preorder tree traversal (MPTT) with the
 fields `parent_left`/`parent_right`[...]

[FIX] account: remove frenglish

 [...]

 Closes #22793
 Fixes #22769

[FIX] website: remove unused alert div, fixes look of input-group-btn

 Bootstrap&#39;s CSS depends on the input-group-btn
 element being the first/last child of its parent.
 This was not the case because of the invisible
 and useless alert.
</pre></div>
</div>
<div role="alert" class="alert alert-info"><h3 class="alert-title">Примечание</h3><p >Используйте длинное описание, чтобы объяснить * почему * не * что <a href="#id1"><span id="id2" class="problematic">*</span></a>, * что * можно увидеть в diff</p></div></section>

          </article>
        </div>
        
        <div id="mask"></div>
      </main>
  </div>

  <div class="floating_action_container">
    <a id="floating_action" class="ripple" href="#">
      <i class="mdi-action-explore"></i>
    </a>
    <div id="floating_action_menu">
      <span class="bubble"></span>
      <ul class="list-group content">
        <li class="list-group-item ripple"><a>Cras justo odio</a></li>
        <li class="list-group-item ripple"><a>Dapibus ac facilisis in</a></li>
        <li class="list-group-item ripple"><a>Morbi leo risus</a></li>
        <li class="list-group-item ripple"><a>Porta ac consectetur ac</a></li>
        <li class="list-group-item ripple"><a>Vestibulum at eros</a></li>
      </ul>
    </div>
  </div>
<!-- 
  <footer>
    <div id="footer" class="container">
      <span class="o_logo o_logo_inverse center-block o_footer_logo"></span>
      <div class="row">
        <div class="col-sm-7 col-md-7 col-lg-6">
          <div class="row">
            <div class="col-xs-6 col-sm-4">
              <span class="menu_title">Community</span>
              <ul>
                <li><a href="https://github.com/odoo/odoo">Github</a></li>
                <li><a href="http://www.odoo.com/page/download">Download</a></li>
                <li class="divider"></li>
                <li><a href="http://runbot.odoo.com/runbot/repo/git-github-com-odoo-enterprise-7">Runbot</a></li>
                <li><a href="https://github.com/odoo/odoo/wiki/Translations">Translations</a></li>
                <li class="divider"></li>
                <li><a href="http://www.odoo.com/page/odoo-community">Mailing Lists</a></li>
                <li><a href="http://www.odoo.com/forum/help-1">Forum</a></li>
              </ul>
            </div>
            <div class="col-xs-6 col-sm-4">
              <span class="menu_title">Services</span>
              <ul>
                <li><a href="https://www.odoo.sh">Odoo Cloud Platform</a></li>
                <li class="divider"></li>
                <li><a href="http://www.odoo.com/help">Support</a></li>
                <li><a href="https://upgrade.odoo.com">Upgrade</a></li>
                <li class="divider"></li>
                <li><a href="http://www.odoo.com/partners">Find a partner</a></li>
                <li><a href="http://www.odoo.com/page/become-a-partner">Become a partner</a></li>
                <li class="divider"></li>
                <li><a href="http://training.odoo.com/courses/odoo-functional">Training Center</a></li>
                <li><a href="http://www.odoo.com/page/education-program">Education</a></li>
                <li class="divider"></li>
                <li><a href="http://www.odoo.com/page/security">Security</a></li>
              </ul>
            </div>
            <div class="col-xs-12 col-sm-4 mb64">
              <span class="menu_title">About us</span>
              <ul>
                <li><a href="http://www.odoo.com/page/about-us">Our company</a></li>
                <li><a href="http://www.odoo.com/page/contactus">Contact</a></li>
                <li class="divider" />
                <li><a href="http://www.odoo.com/event">Events</a></li>
                <li><a href="http://www.odoo.com/blog">Blog</a></li>
                <li><a href="http://www.odoo.com/blog/6">Customers</a></li>
                <li class="divider" />
                <li><a href="http://www.odoo.com/jobs">Jobs</a></li>
                <li class="divider" />
                <li><a href="http://www.odoo.com/page/legal">Legal</a> | <a href="http://www.odoo.com/privacy">Privacy</a></li>
              </ul>
            </div>
          </div>
        </div>
        <div class="col-sm-5 col-md-4 col-md-offset-1 col-lg-5 col-lg-offset-1">
          <p>
            <small>
              Odoo is a suite of open source business apps that cover all your company needs: CRM, eCommerce, accounting, inventory, point of sale, project management, etc.
              <br/><br/>
              Odoo's unique value proposition is to be at the same time very easy to use and fully integrated.
            </small>
          </p>
        </div>
      </div>
    </div>
    <div class="o_footer_bottom">
      <div class="container">
        <a class="small" href="http://www.odoo.com/page/website-builder">Website made with <span class="o_logo o_logo_inverse o_logo_15"></span></a>
        <div class="social-links pull-right">
          <a href="http://www.odoo.com/web/about/facebook"><i class="fa fa-facebook"></i></a>
          <a href="http://www.odoo.com/web/about/twitter"><i class="fa fa-twitter"></i></a>
          <a href="http://www.odoo.com/web/about/linkedin"><i class="fa fa-linkedin"></i></a>
          <a href="mailto:info@odoo.com"><i class="fa fa-envelope"></i></a>
        </div>
      </div>
    </div>
  </footer>
  -->
  </body>
</html>